<!--
/*
' Copyright 2022~2024 USBONG
'
' Licensed under the Apache License, Version 2.0 (the "License"); you may not use this file except in compliance with the License. You ' may obtain a copy of the License at
'
' http://www.apache.org/licenses/LICENSE-2.0
'
' Unless required by applicable law or agreed to in writing, software distributed under the License is distributed on an "AS IS" BASIS, ' WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the License for the specific language governing ' permissions and limitations under the License.
'
' @company: USBONG
' @author: SYSON, MICHAEL B.
' @date created: 20221214
' @date updated: 20241112; from 20241111
' @website: www.usbong.ph
'
'
' Notes:
' 1) website address: http://localhost/usbong_2DAnimationTool/html_application/usbongMotionTweenTool.html;
' last accessed: 20230410
'
' References:
' 1) https://phantomjs.org/; last accessed: 20200724
' downloaded phantomjs zipped file's examples: netsniff.js; last accessed: 20200725
'
' 2) https://nodejs.org/en/download/; last accessed: 20221214
' execute: .js file via: node halimbawa.js
' https://askubuntu.com/questions/1297994/what-is-the-simplest-way-to-run-javascript-code-on-ubuntu; last accessed: 20221214
'
' 3) http://localhost/usbong_2DAnimationTool/html_application/usbong2DAnimationTool.html;
' last accessed: 20230311
'
' 4) https://stackoverflow.com/questions/5027950/coordinates-for-my-javascript-game-based-on-an-angle-when-do-i-use-sin-cos-an;
' last accessed: 20230426
' answer by: Jimmy, 20110217T1212; from 20110217T1106
'
' 5) https://www.mathsisfun.com/sine-cosine-tangent.html;
' last accessed: 20230426
'
'*/
//added by Mike, 20230313
//TO-DO: -add: adjustable "STAGE" SIZE textbox
//TO-DO: -add: timeline?; remembers: DIRECTOR6, FLASH tool
//TO-DO: -note: location of image sprite file in assets folder, editable using GIMP tool
-->

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
<!-- TO-DO: -update: this -->
<!-- //edited by Mike, 20230314 //TO-DO: -add: option to set IF from internet
-->

<!--
  	<base href="http://localhost/usbong_2DAnimationTool/" target="_blank">
  	<base href="http://store.usbong.ph/" target="_blank">
-->

  </head>

  <title>
    Usbong Game Off 2024
  </title>

  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />

  <style type="text/css">
		html, body
        {
            font-family: Arial;
			font-size: 11pt;

			/* edited by Mike, 20220911
			width: 640px;
			*/
			width: 100%; /*90%; 80%;*/
			height: 100%;

			/*added by Mike, 20231119*/
			background-color: white; /*black; transparent*/
			border: none;


			padding: 0;
			margin: 0;

			/* //added by Mike, 20221002
			//reference: https://www.w3schools.com/howto/howto_css_disable_text_selection.asp;
			//last accessed: 20221002
			*/

			-webkit-user-select: none; /* Safari */
			-ms-user-select: none; /* IE 10 and IE 11 */
			user-select: none; /* Standard syntax */

			/* added by Mike, 20221012 */
			transform: scale(1.0);

			/* added by Mike, 20221119 */
			touch-action: none;
		}

		canvas.myCanvas {
      position: absolute;

			padding: 0;
			margin: auto;
			display: block;

/*
			width: 320px;
			height: 288px;
*/

/*			width: 448px; *//*640px;*/
/*			height: 402px; *//*576px;*/

			width: 640px;
			height: 360px;

			/*	//removed by Mike, 20231121
				border: 1px solid gray;
			*/

/*
			padding: -10px;
*/
      visibility: hidden;

			border: 1px dotted gray;

			z-index: -1;
		}
		
		canvas.myCanvasSnowEffect {
			position: absolute;

			padding: 0;
			margin: auto;
			display: block;


			width: 640px;
			height: 360px;

			visibility: hidden;

			border: 1px dotted gray;

			z-index: 10;
		}
		
		div.myDivSnowEffect
		 {
			position: absolute;

			background-color: white; /*pink;*/
			
			padding: 0;
			margin: auto;
			display: block;


			width: 5px; /*10px;*/
			height: 5px; /*10px;*/


			visibility: visible;
/*

			border: 1px dotted gray;
*/
			z-index: 20;
		}

		div.myDivTransitionEffect
		{
			position: absolute;

			background-color: black; /*pink;*/
			
			padding: 0;
			margin: auto;
			display: block;


			width: 360px;
			height: 360px;


			visibility: visible; /*hidden;*/
			z-index: 99;
			
			transform: scale(0, 0);
		}
		

		.ImageTileFrame1 {
			position: absolute;

			clip: rect(0px,32px,32px,0px);
			visibility: hidden;
			
			z-index: 3; /*2;*/
		}
		
		.ImageHeroFrame1 {
			position: absolute;

			clip: rect(0px,32px,32px,0px);
			
			visibility: hidden;
						
			z-index: 3;
		}

		.ImageTankFrame1 {
			position: absolute;

			clip: rect(0px,64px,64px,0px);
			visibility: hidden;
			
			z-index: 3;
		}
		

    .ImageMonsterBoss {
			position: absolute;

      clip: rect(0px,128px,128px,0px);

      width:512px;
      height: auto;

			visibility: hidden;
			
			z-index: 2;
		}

    .ImageMonster0 {
      position: absolute;

      clip: rect(0px,64px,64px,0px);

      visibility: hidden;
    }
	
	 .ImageMainSoldier {
			position: absolute;
/*
			width: 768px;
			height: 256px;
			
			object-fit: contain;

			clip: rect(0px,64px,64px,0px);
*/
			visibility: hidden;
			
			z-index: 2;
		}

	 .ImageBossBattleBgPart2 {
			position: absolute;
			visibility: hidden;
			
			z-index: 2;
		}
		

		.ImageMouseInput {
			position: absolute;

			clip: rect(0px,64px,64px,0px);
/*
			clip: rect(0px,32px,32px,0px);
*/
			visibility: hidden; /*visible;*/
		}


		.ImageExplosion {
			position: absolute;

			/*	//edited by Mike, 20231120
				clip: rect(0px,256px,256px,0px);
			*/

			clip: rect(0px,128px,128px,0px);

			visibility: hidden;

			z-index: 10; /*4;*/
		}
		
		
		.ImageExplosionToCity {
			position: absolute;

			clip: rect(0px,128px,128px,0px);
/*
			width: 64px; 
			height: auto;
*/
			object-fit: contain;
			
			visibility: hidden;
/*			
			scale: 0.5;
*/
			z-index: 10; /*4;*/
		}

		.ImageDust {
			position: absolute;

			clip: rect(0px,32px,32px,0px);

			visibility: hidden;

			z-index: 10; /*4;*/
		}
		
		.ImageHowToPlayGuide {
			position: absolute;

			text-align: center;
			line-height: 32px;

			visibility: hidden;

			width: 640px;
			height: 360px;

			/* //added by Mike, 20221104 */
			z-index: 10;
		}

		.ImageTitle {
			position: absolute;

			text-align: center;
			line-height: 32px;

			visibility: hidden;

			/* //edited by Mike, 20230121
			//notes: @640px, excess shaking via MS EDGE Browser
			*/
			width: 480px; /*640px;*/

			object-fit: contain;

			z-index: 10;
		}

		.ImageBossBattleBg {
			position: absolute;

			text-align: center;
			line-height: 32px;

			visibility: hidden;

			width: 360px; /*600*/
			height: auto;

			object-fit: contain;
			
			z-index: 1;
		}

		
		.ButtonSet, .TextInputSet {
			position: relative; /*absolute;*/
			font-size: 20px;
		}

		.LabelSet {
			position: relative; /*absolute;*/
			font-size: 24px;

			font-weight: bolder; /*bold;*/
		}

		.SelectAnimDirection {
			font-size: 22px;
		}

		table.TableSetPanel
		{
			position: absolute;
			border: 2px dotted #ab9c7d;
			margin-top: 0px; /*10px*/

			visibility: hidden;
		}


		.Image32x32Tile {
			position: absolute;
/*
			width: 256px;
			height: 256px;

			object-fit: contain;

			clip: rect(0px,64px,64px,0px);
*/
/*	//edited by Mike, 20231116
			width: 512px;
*/
			width: 768px;
			height: 256px;

			object-fit: contain;

			clip: rect(0px,64px,64px,0px);

			background-color: #f7f7f7; /*transparent;*/
/*
			border: none;
*/
			color: #222222;

			/* //removed by Mike, 20221111
			opacity: 0.5;*/

			font-weight: bold;
			/*font-size: 146%;*/ /*20px;*/
/*
			text-align: center;
			line-height: 32px;
*/

			border: 1px dotted gray;

			visibility: hidden;

			margin: 0px; /*1px;*/
			padding: 0px;

			z-index: 2; /*3;*/
		}


    		/* noted by Mike, 20221105 */
    		.Image32x32TileTarget {
    			position: absolute;

    /* //added by Mike, 20221113; edited by Mike, 20230111*/
    /*
    			width: 128px;
    			height: 128px;
    */
    			width: 256px;
    			height: 256px;

    			object-fit: contain;


    			/* //added by Mike, 20221112; edited by Mike, 20230111 */
    /*
    			clip: rect(0px,32px,32px,0px);
    */
    			clip: rect(0px,64px,64px,0px);

    /* //removed by Mike, 20221112
    			width: 32px;
    			height: 32px;
    */

    /* //edited by Mike, 20221112 */
    /*
    			background-color: #ffffff;
    */
    background-color: transparent;
    border: none;
    			color: #222222;

    			/* //added by Mike, 20221111
    			   //TO-DO: -update: this
    			*/
    			opacity: 0.5;

    			font-weight: bold;
    			font-size: 146%; /*18px;*/

    			text-align: center;
    			line-height: 32px;

    			/*padding-top: 0.1875%;*/ /*6px;*/

    /* //note: with clip rect border is put on entire sprite image */
    /* //removed by Mike, 20221112
    			border: 3px solid #ff0000;
    			border-radius: 3px;
    */
    			margin: 0px; /*1px;*/
    			padding: 0px;
    			z-index: 4;
    		}

    		.Image32x32TileTargetBorder {
    			position: absolute;
    /*
    edited by Mike, 20230111
    			width: 27px;
    			height: 27px;
    */
    			width: 58px;
    			height: 58px;

    			background-color: transparent;
    			color: #222222;

    			font-weight: bold;
    			font-size: 146%; /*18px;*/

    			text-align: center;
    			line-height: 32px;

    			border: 3px dashed #ff0000;
    			border-radius: 3px;

    			visibility: hidden;

    			margin: 0px;
    			padding: 0px;
    			z-index: 4;
    		}

    		.Image32x32TileSpaceBorder {
    			position: absolute;

    /*
    edited by Mike, 20230111
    			width: 27px;
    			height: 27px;
    */
    			width: 58px;
    			height: 58px;

    			background-color: transparent; /*#ffffff;*/

    			color: #222222;

    			font-weight: bold;
    			font-size: 146%; /*18px;*/

    			text-align: center;
    			line-height: 32px;

    			border: 3px dashed #00ff00; /*#ffffff*/
    			border-radius: 3px;

    			visibility: hidden;

    			margin: 0px;
    			padding: 0px;
    			z-index: 4;
    		}


    		.Image32x32TileSpaceTarget {
    			position: absolute;

    /*
    edited by Mike, 20230111
    			width: 27px;
    			height: 27px;
    */
    			width: 58px;
    			height: 58px;

    			background-color: #000000; /*#ffffff;*/
    			color: #222222;

    			text-align: center;
    			line-height: 32px;

    			border: 3px solid #ffffff; /*#ff0000;*/
    			border-radius: 3px;

    			margin: 0px;
    			padding: 0px;
    			z-index: 5;
    		}

    		/* added by Mike, 20221105 */
    		.Image32x32TileSpace {
    			position: absolute;

    /* //added by Mike, 20221113; edited by Mike, 20230111*/
    /*
    			width: 128px;
    			height: 128px;
    */
    			width: 256px;
    			height: 256px;
    			object-fit: contain;

    			/* //added by Mike, 20221112; edited by Mike, 20230111 */
    /*
    			clip: rect(0px,32px,32px,0px);
    */
    			clip: rect(0px,64px,64px,0px);


    /* //removed by Mike, 20221112
    			width: 32px;
    			height: 32px;
    */

    /* //edited by Mike, 20221112 */
    /*
    			background-color: #222222;
    */
    background-color: transparent;
    border: none;
    			color: #222222;

    			text-align: center;
    			line-height: 32px;

    			/*padding-top: 0.1875%;*/ /*6px;*/

    /* //note: with clip rect border is put on entire sprite image */
    /* //removed by Mike, 20221112
    			border: 3px solid #ff0000;
    			border-radius: 3px;
    */
    			margin: 0px; /*1px;*/
    			padding: 0px;

    			z-index: 3;
    		}


			/*added by Mike, 20231111 */
			div.DivTextStatus
			{
				position: absolute;

/*	//edited by Mike, 20221213
				background-color: #000000aa;
*/
/*
				background-color: #00000099;
				
*/
				background-color: transparent;

				color: #eeeeee; /*#ffffff;*/ /*#ffbd00;*/ /* gold */

				/*
				border: 3px solid #ffffff;				
				border-radius: 4px;
*/

				/*opacity: 50%;*/

				font-size: 30px; /*16px;*/
				font-weight: bold;

/* //edited by Mike, 20230130
				margin: 10px;
*/
				padding: 10px;

				visibility: hidden;

				/* added by Mike, 20230128;
					put above tile images */
				z-index: 90; /*4;*/
			}

			div.DivTextStatusBackground
			{
				position: absolute;

				background-color: #00000099;
				border: 3px solid #ffffff;				
				border-radius: 4px;

				font-size: 30px; /*16px;*/
				font-weight: bold;

				padding: 10px;
				
				width: 120px; 
				height: 120px; 

				visibility: hidden;

				/* added by Mike, 20230128;
					put above tile images */
				z-index: 80; /*4;*/
			}

			
			div.DivStepCountStatusShadow
			{
				position: absolute;
/*
				background-color: #000000aa;
*/
				/*color: #ffffff;*/ /* white */

				color: #6d4e22; /* brown */

				/*opacity: 50%;*/

				font-size: 32px;/*42px;*/
				font-weight: bold;

/* //edited by Mike, 20230130
				padding: 10px;
*/
				/* //changed from margin */
				/* //edited by Mike, 20230130
				margin: 10px;
				*/
				padding: 0px;


				visibility: hidden;

				/* put above image tiles;
					below step count button
				*/
				z-index: 90; /*4;*/
			}



			div.DivTextEnter
			{
				position: absolute;
				/*background-color: #000000aa;*/
				color: #000000; /*#ffffff;*/

				/*opacity: 50%;*/

				font-size: 16px;
				font-weight: bold;

				/* //noted by Mike, 20230130 */
				padding: 10px;

				visibility: visible;
			}

			div.DivTextClickStart
			{
				position: absolute;
				background-color: #4d4d4d;
				color: #ffffff; /*#ffffff;*/

				/*opacity: 50%;*/

				font-size: 16px;
				font-weight: bold;

				/* //noted by Mike, 20230130 */
				padding: 10px;
				padding-right: 40px;
				padding-left: 40px;

    			border: 3px solid #4d4d4d;
    			border-radius: 3px;

				visibility: hidden;
			}

			div.DivTextScore
			{
				position: absolute;
/*
				background-color: #000000aa;
*/
				color: #6d4e22; /* brown */

				/*color: #ffffff;*/ /* white */

				/*opacity: 50%;*/

				font-size: 32px;/*42px;*/
				font-weight: bold;

/* //edited by Mike, 20230130
				padding: 10px;
*/
				/* //changed from margin */
				/* //edited by Mike, 20230130
				margin: 10px;
				*/
				padding: 0px;

				visibility: hidden;

				/* put above image tiles;
					below step count button
				*/
				z-index: 90; /*4;*/
			}




      audio.myAudio
      {
        width: 416px;
        height: 312px;

        /* added by Mike, 20230115 */
        visibility: hidden;
      }


  </style>

  <script>


//added by Mike, 20221105
bIsTargetAtSpace = true;

iTargetAtSpaceBlinkAnimationCount=0;
iTargetAtSpaceBlinkAnimationCountMax=6;

//added by Mike, 20221106
iTargetTileBgCount=-1;

//added by Mike, 20221106
//note: 4x4
var iRowCount=0;
const iRowCountMax=4;
var iColumnCount=0;
const iColumnCountMax=4;
var arrayPuzzleTileCountId = [];
var arrayPuzzleTilePos = [ [],[],[],[] ];

const iTileBgCountMax=iRowCountMax*iColumnCountMax;

//added by Mike, 20231123
var bSoldierTileTypeDone=false;
var bTankTileTypeDone=false;
var bBuildingTileTypeDone=false;


//added by Mike, 20231109
var bHasHitTileWithForeignKey=false;
var bIsPuzzleDone=false;

var bHasClosedPuzzle=false;

//added by Mike, 20231124
var bIsBossBattleDone=false;

var bIsHeroInTank=false;

var bIsHeroAttacked=false;


//added by Mike, 20231126
var bIsMonsterBossHit=false;
//edited by Mike, 20231129
var iBossLife=3;//1;//50;

//added by Mike, 20231111
var bIsActionKeyPressed=false;

//added by Mike, 20231119
var bIsPuzzleTileTargetHit=false;

//added by Mike, 20231114
var iInputDelayCountMax=3;
var iInputDelayCount=iInputDelayCountMax;

//added by Mike, 20231122
var bHasViewedHowToPlayGuide=false;

//added by Mike, 20231116
var bIsStillUsingItchScreen=false;

//added by Mike, 20231111
//reference: https://github.com/usbong/tugon/blob/main/mainLinux.cpp;
//last accessed: 20221125
var bIsExecutingShake=false;
var iDestroyHumanShakeDelayCount=0;
var iDestroyHumanShakeDelayMax=5;

var iShakeOffsetWidthMax=2;
var iShakeOffsetHeightMax=2;

var iShakeOffsetWidth=iShakeOffsetWidthMax;
var iShakeOffsetHeight=iShakeOffsetHeightMax;

var iHeroInvincibileCount=0;
var iHeroInvincibileCountMax=10;


//added by Mike, 20231112
const sAudioEffectActionStart="assets/audio/usbongGameOff2023TapLoudEdited.mp3";

//added by Mike, 20231114
const sAudioEffectLowPower="assets/audio/voiceover/lowpower.mp3";

//added by Mike, 20231130
const sAudioEffectActionCannonFire ="assets/audio/usbongGameOff2023AudioEffectsCannon.mp3";


//added by Mike, 20231129
//TODO: -update: this
const sAudioBGM="assets/audio/usbongGameOff2023BGM.mp3";


//added by Mike, 20231115
var iAnimationCount=-1;//0; start at -1
var iAnimationCountMax=5;
var iAnimationDelayCount=10; //0
var iAnimationDelayCountMax=10;

//added by Mike, 20231127
var iMonsterAnimationCount=-1;//0; start at -1
var iMonsterAnimationCountMax=5;
var iMonsterAnimationDelayCount=10; //bat; //0
var iMonsterAnimationDelayCountMax=6;

var iBossMonsterAnimationCount=-1;//0; start at -1
var iBossMonsterAnimationCountMax=5;
var iBossMonsterAnimationDelayCount=10; //0
var iBossMonsterAnimationDelayCountMax=10;


//added by Mike, 20231119
var iExplosionEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iExplosionEffectAnimationCountMax=5;
var iExplosionEffectAnimationDelayCount=0;
var iExplosionEffectAnimationDelayCountMax=4;//1;

//added by Mike, 20231127
var iMonsterExplosionEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iMonsterExplosionEffectAnimationCountMax=5;
var iMonsterExplosionEffectAnimationDelayCount=0;
//edited by Mike, 20231128
var iMonsterExplosionEffectAnimationDelayCountMax=2;//4;//1;

//added by Mike, 20241105
var iDustEffectAnimationCount=-1; //0; //due to immediately +1 in execution;
var iDustEffectAnimationCountMax=5;
var iDustEffectAnimationDelayCount=0;
var iDustEffectAnimationDelayCountMax=4;//1;

//added by Mike, 20231128
var iTransitionFromPuzzleToBossDelayCount=0;
var iTransitionFromPuzzleToBossDelayCountMax=150;//100;

//added by Mike, 20231128
var iMonsterBossAttackDelayCount=0;
var iMonsterBossAttackDelayCountMax=120;

//added by Mike, 20231120
var iImageExplosionEffectAnimationWidth=64;
var iImageExplosionEffectAnimationHeight=64;

//added by Mike, 20241105
var iImageDustEffectAnimationWidth=32;
var iImageDustEffectAnimationHeight=32;

//added by Mike, 20231127
var iTransitionRotate=0;
var iTransitionScale=0;//1;
var iTransitionDelayCount=0;
var iTransitionDelayCountMax=20;

var bIsExecutingTransition=false;
var bIsTransitionFirstPartDone=false;

//added by Mike, 20231121
var iMouseAnimationCount=-1; //0; //due to immediately +1 in execution;
var iMouseAnimationCountMax=5;
var iMouseAnimationDelayCount=0;
var iMouseAnimationDelayCountMax=2;//1;

//added by Mike, 20241105
var iMouseClickStartTime=0;
var iMouseClickMaxElapsedTime=250; //1/4 second
var bIsHeroDash=false;

//added by Mike, 20241103
var iHeroAnimationCount=-1; //0; //due to immediately +1 in execution;
var iHeroAnimationCountMax=5;
var iHeroAnimationDelayCount=0;
var iHeroAnimationDelayCountMax=5;//2;//1; //TODO: -add: more dust effect if target walking distance is far

//edited by Mike, 20231124; from 20231123
var iScore=10000;//0;
var iTargetScore=10000;//0;

//added by Mike, 20231129; from 20231124
var bIsIncreasingScore=false;//true;

//added by Mike, 20231125
var iTextScoreDivWidthOffset=5;
var iTextScoreDivWidth;
var iTextScoreShadowDivWidthOffset=1;

//added by Mike, 20231127
var iCurrSnowFlakeCount=0;
var iCurrSnowFlakeCountMax=20;
var iCurrSnowFlakeCountPosX=0;
var iCurrSnowFlakeCountPosY=0;

//added by Mike, 20231129
var iSoldierAnimationScale=0;

//added by Mike, 20231124
//note: acceleration

//min 2; not 1
var mainImageTileProjectileStepYMax=6;//10;//4;//20;//20;
var mainImageTileProjectileStepXMax=6;//10;//4;//20;//20;

var mainImageTileProjectileVelocityY=2;//4;//20;//4;//1;
var mainImageTileProjectileVelocityX=2;//4;//20;//4;//1;

var mainImageTileProjectileStepYMin=mainImageTileProjectileVelocityY;//4;//12;
var mainImageTileProjectileStepXMin=mainImageTileProjectileVelocityX;//4;//12;

var mainImageTileProjectileStepY=mainImageTileProjectileStepYMin;//20;
var mainImageTileProjectileStepX=mainImageTileProjectileStepYMin;//20;

//added by Mike, 20241103
var mainImageTileProjectileStepDestinationY=0;
var mainImageTileProjectileStepDestinationX=0;


//added by Mike, 20231125
var mainImageMonsterPosX=0;
var mainImageMonsterPosY=0;

//added by Mike, 20231126
var mainImageMonsterBossPosX=500;
var mainImageMonsterBossPosY=10;


//added by Mike, 20231124
//note: parameters
var iDefaultAnimationImageX=0;//-32; //default x
var iDefaultAnimationImageY=0;//-32; //default y

//edited by Mike, 20230418
//iTotalAnimImageFrameCount=4;//2;
var iTotalAnimImageFrameCount=2;

var iImageFrameWidth=32;// 64; //0;
var iImageFrameHeight=32;// 64;

var iImageFrameWidthLarge=64;
var iImageFrameHeightLarge=64;

var iImageFrameWidthDefault=32;
var iImageFrameHeightDefault=32;

//added by Mike, 20231121
var iMouseInputImageWidth=64;
var iMouseInputImageHeight=64;


//added by Mike, 20231128
var iCurrTextCharacterCount=0;
var iCurrTextCharacterCountMax=0;
var sCurrText="";

//added by Mike, 20231128
var iTitleExplosionEffectDelayCount=0;
var iTitleExplosionEffectDelayCountMax=200;

//added by Mike, 20231128
var iTitlePressStartEffectDelayCount=0;
var iTitlePressStartEffectDelayCountMax=5;

//added by Mike, 20231129
var ihowToPlayGuideImageFrame2DelayCount=0;
var ihowToPlayGuideImageFrame2DelayCountMax=8;


/*
//added by Mike, 20221108
var iCountMovementStep=0;

//added by Mike, 20221213
const iCountInitMovementStepMax=15;
const iCountMovementStepMax=100-iCountInitMovementStepMax;

//added by Mike, 20221214
var arrayCountMovementStep= [];

var bIsInitAutoGeneratePuzzleFromEnd=false;
var iDelayAnimationCountMovementStep=0;
const iDelayAnimationCountMovementStepMax=6;

//added by Mike, 20221129
var iPrevDirection=0;
*/

//added by Mike, 20231119; from 20221121
var iDelayAnimationCountEnter=0;
const iDelayAnimationCountEnterMax=10;

//added by Mike, 20231121
var bHasViewedTitle=false;

var bHasPressedStart=false;


//added by Mike, 20230123
var iPuzzleTileWidth=64;
var iPuzzleTileHeight=64;

//added by Mike, 20230123
const iPuzzleTileTotalWidthMax=iPuzzleTileWidth*iColumnCountMax;
const iPuzzleTileTotalHeightMax=iPuzzleTileHeight*iRowCountMax;

//added by Mike, 20231126
var iMonsterTileWidth=64;
var iMonsterTileHeight=64;

var iMonsterBossTileWidth=128;
var iMonsterBossTileHeight=128;

var iBorderOffset=0;
var iOffsetWidth=0;
var iOffsetHeight=0;



	//added by Mike, 20221214
	var iCountMovementStep=0;
	const iCountInitMovementStepMax=15;
	const iCountMovementStepMax=100-iCountInitMovementStepMax;
	//edited by Mike, 20230421; from 20230418
	var iCountMovementStepDelay=0;
	const iCountMovementStepDelayMax=10;

	//added by Mike, 20230421
	//SOH-CAH-TOA
	//note: Max increase incrementally angle to end destination
	const iCountMovementDiagonalStepMax=5; //10
	var iCountMovementDiagonalStep=iCountMovementDiagonalStepMax;
	//edited by Mike, 20230426; from 20230425
	//360 and 0, @12 o'clock; rotation; image and step direction
	//inverted y;
	//SOH-CAH-TOA; where: use of cos and sin also interchanged;
	var iMainImageTileStepAngle=0;
    //var iMainImageTileStepAngleTemp=0;

    //added by Mike, 20230427
    var newMainImageTileProjectilePosX=0;
    var newMainImageTileProjectilePosY=0;
    var bHasFired=false;

	//added by Mike, 20230423
	var iMousePointPosX=0;
	var iMousePointPosY=0;

	var iPrevDirection=0;
	var bIsInitAutoGeneratePuzzleFromEnd=true;

	const iKEY_W = 0;
	const iKEY_S = 1;
	const iKEY_A = 2;
	const iKEY_D = 3;

	//edited by Mike, 20231125; from 20230418
/*
	const iKEY_I = 4;
	const iKEY_K = 5;
	const iKEY_J = 6;
	const iKEY_L = 7;


	//added by Mike, 20230418
	const iKEY_Q = 4; //TOP-LEFT
	const iKEY_E = 5; //TOP-RIGHT
	const iKEY_C = 6; //BOTTOM-RIGHT
	const iKEY_Z = 7; //BOTTOM-LEFT

	const iKEY_I = 8;
	const iKEY_K = 9;
	const iKEY_J = 10;
	const iKEY_L = 11;

	//edited by Mike, 20230418
	const iTotalKeyCount = 12; //8; //4;
	const iDirectionTotalKeyCount = 8; //4;
*/
	const iTotalKeyCount = 4; //8; //12;
	const iDirectionTotalKeyCount = 4; //8

	//added by Mike, 20230421
	var iDirection=-1;

	//added by Mike, 20231125
	//https://www.w3schools.com/js/js_arrays.asp; last accessed: 20220823
	const arrayKeyPressed = [];
	for (iCount=0; iCount<iTotalKeyCount; iCount++) {
		arrayKeyPressed[iCount]=false;
	}


	var arrayCountMovementStep= [];

	//added by Mike, 20230311
	var iFacingDirection=0;

	const iFACING_DOWN=0;
	const iFACING_UP=1;
	const iFACING_LEFT=2;
	const iFACING_RIGHT=3;

	//edited by Mike, 20230314
	//note: VALUES set in init()
	//const iTotalAnimImageFrameCount=2;//6;
	var iTotalAnimImageFrameCount;//=4;//6;
	var iAnimImageFrameCount;//=0;

	var iDefaultAnimationImageX;//=0; //default x
	var iDefaultAnimationImageY;//=0;//-32; //default y

//	var iTotalAnimImageFrameCount=4;

	/*	//removed by Mike, 20230312
	var iImageFrameSizeX=0;
	var iImageFrameSizeY=32;
*/
	//added by Mike, 20230315
	//edited by Mike, 20230418
	//var iAnimImageDirection=0; //vertical
	var iAnimImageDirection=1; //horizontal

	const AnimImageDirection_VERTICAL=0;
	const AnimImageDirection_HORIZONTAL=1;


	var bIsWalkingAction=true; //false;

	//edited by Mike, 20221129
	//1000/60=16.66; 60 frames per second
	//1000/30=33.33; 30 frames
	const fFramesPerSecondDefault=16.66;
	//const fFramesPerSecondDefault=33.33;
	var fFramesPerSecond=fFramesPerSecondDefault;
	var iCurrentIntervalId=-1;

	//edited by Mike, 20230315; from 20230311
	//adds 6 frames before frame update
	var iDelayAnimationCountMovementStep=0;
	var iDelayAnimationCountMovementStepMax=12; //6;

	//added by Mike, 20230410
	var mainImageTilePosX=0;
	var mainImageTilePosY=0;
	//edited by Mike, 20230418
	var mainImageTileStepX=2;//0; //2;
	var mainImageTileStepY=2;//0; //2;

	//added by Mike, 20230427
	var mainImageTileProjectilePosX=0;
	var mainImageTileProjectilePosY=0;
	
	var bHasReachedDestinationY=false;
	var bHasReachedDestinationX=false;
	
	var iPrevMouseXPos=-1;
	var iPrevMouseYPos=-1;
	
	//TODO: -do code refactoring; there's also iFacingDirection
	var bIsHeroFacingLeft=false;
		
	//added by Mike, 20241111
	//TODO: -put in array;
	var batMonsterImageTilePosX=0;
	var batMonsterImageTilePosY=0;
	var batMonsterTileStepX=2;
	var batMonsterTileStepY=2;
	var batMonsterTileStepDelay=0;	
	var batMonsterTileStepDelayMax=5;	
	var isBatMonsterTileActive=false;
	
	
	//added by Mike, 20241106
	var iCurrMapLocation=53;//12;//0;
		
	var hasInitMapLocation=false;	
		

/*	//removed by Mike, 20231124
	//edited by Mike, 20230418
	var mainImageTileProjectileStepX=2;//0; //2;
	var mainImageTileProjectileStepY=2;//0; //2;
*/

	//edited by Mike, 20230314
/*
	const iStageMaxWidth=160*2; //160;
	const iStageMaxHeight=144*2; //144;
*/
	//TO-DO: -add: auto-update Canvas' width and height to be EXACT
/*	//edited by Mike, 20231121
	var iStageMaxWidth=448; //640;
	var iStageMaxHeight=402; //576;
*/

/*
	var iStageMaxWidth=640;
	var iStageMaxHeight=360; //480
*/
	var iStageMaxWidth=640;
	var iStageMaxHeight=360;


//	var iHorizontalOffset=0;
	var iVerticalOffset=0;

	//note: for INNER SCREEN
//edited by Mike, 20231126; itch.io; screen.width appears to cause incorrect output;
//due to itch.io window top-left at 0;
//iHorizontalOffset=(screen.width)/2-iStageMaxWidth/2;
iHorizontalOffset=0;

//edited by Mike, 20231126
iVerticalOffsetInnerScreen=0;
//iVerticalOffsetInnerScreen=10;

/*
	//added by Mike, 20230312
	//note: press TAB, then ENTER to SET
	function setAnimImageFrameX() {
		var setAnimImageFrameXText = document.getElementById("textSetAnimImageFrameXId");

		//notes: auto-sets to negative number;
		//TO-DO: -add: a checkbox as switch?
		if (setAnimImageFrameXText.value>0) {
			setAnimImageFrameXText.value=setAnimImageFrameXText.value*-1;
		}

		//alert(setAnimImageFrameXText.value);
		iDefaultAnimationImageX=setAnimImageFrameXText.value;//-32;
	}

	function setAnimImageFrameY() {
		var setAnimImageFrameYText = document.getElementById("textSetAnimImageFrameYId");

		//notes: auto-sets to negative number;
		//TO-DO: -add: a checkbox as switch?
		if (setAnimImageFrameYText.value>0) {
			setAnimImageFrameYText.value=setAnimImageFrameYText.value*-1;
		}

		//alert(setAnimImageFrameXText.value);
		iDefaultAnimationImageY=setAnimImageFrameYText.value;//-32;
	}

	function setAnimImageFrameWidth() {
		var setAnimImageFrameWidthText = document.getElementById("textSetAnimImageFrameWidthId");

		//alert(setAnimImageFrameXText.value);
		iImageFrameWidth=setAnimImageFrameWidthText.value;//-32;
	}

	function setAnimImageFrameHeight() {
		var setAnimImageFrameHeightText = document.getElementById("textSetAnimImageFrameHeightId");

		//alert(setAnimImageFrameXText.value);
		iImageFrameHeight=setAnimImageFrameHeightText.value;//-32;
	}

	function setAnimDelay() {
		var setAnimDelayText = document.getElementById("textSetAnimDelayId");
					iDelayAnimationCountMovementStepMax=setAnimDelayText.value;
	}

	function setTotalAnimImageFrameCount() {
		var setTotalAnimImageFrameCountText = document.getElementById("textSetTotalAnimImageFrameCountId");

		//notes: auto-sets to positive number;
		if (setTotalAnimImageFrameCountText.value<0) {
			setTotalAnimImageFrameCountText.value=setTotalAnimImageFrameCountText.value*-1;
		}

		//edited by Mike, 20230314
		iTotalAnimImageFrameCount=setTotalAnimImageFrameCountText.value;
	}
*/

//added by Mike, 20241102
//https://www.w3schools.com/howto/howto_js_fullscreen.asp; last accessed: 20241102

/* Get the documentElement (<html>) to display the page in fullscreen */
var elem = document.documentElement;

/* View in fullscreen */
function openFullscreen() {
  if (elem.requestFullscreen) {
    elem.requestFullscreen();
  } else if (elem.webkitRequestFullscreen) { /* Safari */
    elem.webkitRequestFullscreen();
  } else if (elem.msRequestFullscreen) { /* IE11 */
    elem.msRequestFullscreen();
  }
/*  
  	var iStageMaxWidth=640*2;
	var iStageMaxHeight=360*2;
	

var scale = 'scale(1)';
document.body.style.webkitTransform =  scale;    // Chrome, Opera, Safari
 document.body.style.msTransform =   scale;       // IE 9
 document.body.style.transform = scale;   
 */
}

/* Close fullscreen */
function closeFullscreen() {
  if (document.exitFullscreen) {
    document.exitFullscreen();
  } else if (document.webkitExitFullscreen) { /* Safari */
    document.webkitExitFullscreen();
  } else if (document.msExitFullscreen) { /* IE11 */
    document.msExitFullscreen();
  }
}

	//added by Mike, 20230427
	function resetProjectile() {
		var mainImageTile = document.getElementById("mainImageTileImageId");

		var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

		var iFrameY=0;

/*
		var iFrameY=0;
		//destination to the left of hero projectile		
		if (newMainImageTileProjectilePosX<0) {
			iFrameY=64*2;//128;
		}
		else {
			iFrameY=64*3;//192;
		}
*/
		
/*	//edited by Mike, 20231125
		//added by Mike, 20230427
		mainImageTileProjectilePosX=iStageMaxWidth/2-iImageFrameWidth/2;

		//edited by Mike, 20231124
		//mainImageTileProjectilePosY=iStageMaxHeight/2-iImageFrameHeight/2;
		mainImageTileProjectilePosY=iStageMaxHeight-iImageFrameHeight;
*/
		mainImageTileProjectilePosX = parseInt(mainImageTile.style.left);
		mainImageTileProjectilePosY =parseInt(mainImageTile.style.top);


		//alert("mainImageTileProjectilePosX: "+mainImageTileProjectilePosX);
		//alert("mainImageTileProjectilePosY: "+mainImageTileProjectilePosY);

/*		
		//TO-DO: -update: newMainImage... step
		newMainImageTileProjectilePosX=0; //mainImageTileProjectilePosX;
		newMainImageTileProjectilePosY=0; //mainImageTileProjectilePosY;
*/
		newMainImageTileProjectilePosX=parseInt(mainImageTileProjectilePosX);
		newMainImageTileProjectilePosY=parseInt(mainImageTileProjectilePosY);

		mainImageTileProjectile.style.left = mainImageTileProjectilePosX+"px";
		mainImageTileProjectile.style.top = mainImageTileProjectilePosY+"px";

		mainImageTileProjectile.style.visibility="hidden";
		bHasFired=false;
		
		bIsHeroDash=false;

		//added by Mike, 20230428
		iMainImageTileStepAngle=0;

		//added by Mike, 20231124
		mainImageTileProjectileStepY=mainImageTileProjectileStepYMin;//20;
		mainImageTileProjectileStepX=mainImageTileProjectileStepXMin;//20;

		bHasReachedDestinationY=false;
		bHasReachedDestinationX=false;
		
/*		//TODO: -verify: this
		mainImageTileProjectileStepDestinationX=mainImageTileProjectilePosX;
		mainImageTileProjectileStepDestinationY=mainImageTileProjectilePosY;	
*/
	
		//TODO: -add: idle animation
		
		iHeroAnimationCount=0; 

/*
		if (bIsHeroFacingLeft) {
			iFrameY=iImageFrameHeight*2;//64*2; 128;
		}
		else {
			iFrameY=iImageFrameHeight*3;//64*3; 192;
		}
*/

		mainImageTileTankBody.style.visibility="hidden";
		mainImageTileHeroBody.style.visibility="hidden";

		if (bIsHeroInTank) {
			if (bIsHeroFacingLeft) {
				iFrameY=iImageFrameHeightLarge*2;//64*2; 128;
			}
			else {
				iFrameY=iImageFrameHeightLarge*3;//64*3; 192;
			}
			
			mainImageTileTankBody.style.visibility="visible";

			mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else {
			if (bIsHeroFacingLeft) {
				iFrameY=iImageFrameHeight*2;//64*2; 128;
			}
			else {
				iFrameY=iImageFrameHeight*3;//64*3; 192;
			}

			mainImageTileHeroBody.style.visibility="visible";

			mainImageTileHeroBody.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}

/*			
		if (bIsHeroAttacked) {
			//alert(">>>>>>>>>DITO");
			//bIsHeroAttacked=false;
		}
*/
			
		//alert("dito");
	}


	function init() {
		var myAudio = document.getElementById("myAudioId");
		
        myAudio.setAttribute("src", sAudioBGM);

        fMyAudioVolume=1.0;//0.4;
        myAudio.volume=fMyAudioVolume;
        myAudio.loop=true;		
        myAudio.play();

		//alert("DITO");	
		//-----------	

/*
		//added by Mike, 20231121
		var myCanvas = document.getElementById("myCanvasId");

		myCanvas.style.top = (iVerticalOffsetInnerScreen+0)+"px";

    //alert(screen.width);

    //removed by Mike, 20231126
		//iHorizontalOffset=myCanvas.getBoundingClientRect().x;
    //iHorizontalOffset=(screen.width)/2-iStageMaxWidth/2;
    iHorizontalOffset=0;

    myCanvas.style.left=iHorizontalOffset+"px";
*/

/*
    //added by Mike, 20231126
//    document.addEventListener("fullscreenchange", function() {
    object.onfullscreenchange = function(){

////      output.innerHTML = "fullscreenchange event fired!";
////      alert("DITO");

	    iHorizontalOffset=(screen.width)/2-iStageMaxWidth/2;
    };
*/

	//removed by Mike, 20241102
	//iHorizontalOffset=(screen.width-iStageMaxWidth)/2;

    //added by Mike, 20231126
    var myCanvasTwo = document.getElementById("myCanvasTwoId");

		myCanvasTwo.style.top = (iVerticalOffsetInnerScreen+0)+"px";

		//iHorizontalOffset=myCanvasTwo.getBoundingClientRect().x;
    myCanvasTwo.style.left = iHorizontalOffset+"px";
    myCanvasTwo.style.visibility="hidden";

		var mainImageTile = document.getElementById("mainImageTileImageId");

		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");

		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

		var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");
		
		var doorImageRight = document.getElementById("doorImageRightId");
		doorImageRight.style.visibility="hidden";
		
		var doorImageLeft = document.getElementById("doorImageLeftId");
		doorImageLeft.style.visibility="hidden";
		
		var doorImageTop = document.getElementById("doorImageTopId");
		doorImageTop.style.visibility="hidden";
		
		var doorImageBottom = document.getElementById("doorImageBottomId");
		doorImageBottom.style.visibility="hidden";

		var batMonsterImageTile = document.getElementById("batMonsterImageId");
		batMonsterImageTile.style.visibility="hidden";

		//added by Mike, 20231121
		var mouseInputImage = document.getElementById("mouseInputImageId");

		//added by Mike, 20231121
		var titleImage = document.getElementById("titleImageId");
		//titleImage.style.visibility="hidden";

		var iTitleImageWidth = (titleImage.clientWidth);
		var iTitleImageHeight = (titleImage.clientHeight);

		titleImage.style.top = (iVerticalOffsetInnerScreen+0+iStageMaxHeight/3 -iTitleImageHeight/2)+"px";
		titleImage.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iTitleImageWidth/2 +"px";


		//added by Mike, 20231123
		var textScoreDiv = document.getElementById("textScoreDivId");

//		var iTextScoreDivWidthOffset=5;
		iTextScoreDivWidth = (textScoreDiv.clientWidth)+iTextScoreDivWidthOffset;

		textScoreDiv.style.left = iHorizontalOffset+iStageMaxWidth-iTextScoreDivWidth+"px";
		textScoreDiv.style.top= (0)+"px";

		//added by Mike, 20231125
		var textScoreShadowDiv = document.getElementById("textScoreShadowDivId");

		//var iTextScoreShadowDivWidthOffset=1;
		//var iTextScoreShadowDivWidth = (textScoreShadowDiv.clientWidth)+iTextScoreShadowDivWidthOffset;

		textScoreShadowDiv.style.left = parseInt(textScoreDiv.style.left)+iTextScoreShadowDivWidthOffset +"px";

		textScoreShadowDiv.style.top = textScoreDiv.style.top;

		mainImageTile.style.visibility = "hidden";

		mainImageTileTankBody.style.visibility = "hidden";

		mainImageTileHeroBody.style.visibility = "hidden";

		mainImageTileProjectile.style.visibility = "hidden";

		if (bIsHeroInTank) {
			iImageFrameWidth=iImageFrameWidthLarge;
		}
		else {
			iImageFrameWidth=iImageFrameWidthDefault;
		}
		
		mainImageTilePosX=iStageMaxWidth/2-iImageFrameWidth/2;
		mainImageTilePosY=iStageMaxHeight/2-iImageFrameHeight;

		mainImageTile.style.left = (iHorizontalOffset+mainImageTilePosX)+"px";
		mainImageTile.style.top = (iVerticalOffsetInnerScreen+mainImageTilePosY)+"px";
		
		//added by Mike, 20231124
		mainImageTileTankBody.style.left = mainImageTile.style.left;
		mainImageTileTankBody.style.top = mainImageTile.style.top;

		//added by Mike, 20231124
		mainImageTileHeroBody.style.left = mainImageTile.style.left;
		mainImageTileHeroBody.style.top = mainImageTile.style.top;

		//cat body
		//mainImageTileTankBody.style.objectPosition = "-" + 128 + "px -" + 192 + "px";
		//mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + 0 + "px";
		//mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + 192 + "px";

		mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + iImageFrameHeightLarge*3 + "px";
		mainImageTileHeroBody.style.objectPosition = "-" + 0 + "px -" + iImageFrameHeight*3 + "px";

		//mainImageTile.style.objectPosition = "-" + iImageFrameWidth*3 + "px -" + iImageFrameHeight*3 + "px";
		
		if (bIsHeroInTank) {
			mainImageTile.style.objectPosition = "-" + iImageFrameWidthLarge*3 + "px -" + iImageFrameHeightLarge*3 + "px";
		}
		else {
			mainImageTile.style.objectPosition = "-" + iImageFrameWidth*3 + "px -" + iImageFrameHeight*3 + "px";
		}
		

		//added by Mike, 20231124
		mainImageTileProjectile.style.objectPosition = "-" + 0 + "px -" + 128 + "px";


		mainImageTileProjectilePosX = mainImageTile.style.left;
		mainImageTileProjectilePosY = mainImageTile.style.top;


		//added by Mike, 20231121

		var textEnterDiv = document.getElementById("textEnterDivId");

			var iTextEnterDivWidth = (textEnterDiv.clientWidth);
			var iTextEnterDivHeight = (textEnterDiv.clientHeight);

			textEnterDiv.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iTextEnterDivWidth/2 +"px";

			textEnterDiv.style.top = 0+iStageMaxHeight-iTextEnterDivHeight*2+"px";

			//alert ("textEnterDiv.style.left: "+textEnterDiv.style.left);
			//alert ("textEnterDiv.style.top: "+textEnterDiv.style.top);

			textEnterDiv.style.visibility="visible";

			iTransitionScale=1;
			
			textEnterDiv.style.transform = "scale("+iTransitionScale+","+iTransitionScale+")";	
			

		var mouseInputImage = document.getElementById("mouseInputImageId");


		mouseInputImage.style.left = (iHorizontalOffset+iStageMaxWidth/2-iTextEnterDivWidth/2+iMouseInputImageWidth/2)+"px";

		mouseInputImage.style.top = (iVerticalOffsetInnerScreen+iStageMaxHeight+iTextEnterDivHeight/2)+"px";

		mouseInputImage.style.objectPosition = "-" + 0 + "px -" + 192 + "px";

    //added by Mike, 20231126
    mainImageMonsterPosX=iHorizontalOffset+iStageMaxWidth/2-iMonsterTileWidth;
//    mainImageMonsterPosY=iVerticalOffsetInnerScreen+iStageMaxHeight/2-iMonsterTileWidth;
    mainImageMonsterPosY=iVerticalOffsetInnerScreen+0-iMonsterTileHeight;

		//removed by Mike, 20231129
		//setMonsterExplosionEffectPosition(parseInt(titleImage.style.left)+iTitleImageWidth*0.15,parseInt(titleImage.style.top)+iTitleImageHeight/3);
		
		bHasReachedDestinationY=false;
		bHasReachedDestinationX=false;		
	}

	//added by Mike, 20231120
	function setExplosionEffectPosition(iTileBgCountInput) {
		var explosionEffectImage = document.getElementById("explosionEffectImageId");

    //added by Mike, 20231126
    if (explosionEffectImage.style.visibility=="visible") {
      return;
    }

		explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";

		explosionEffectImage.style.visibility="visible";

		iExplosionEffectAnimationDelayCount=iExplosionEffectAnimationDelayCountMax;

		iExplosionEffectAnimationCount=-1; //0;

		explosionEffectImage.style.left = parseInt(arrayPuzzleTileCountId[iTileBgCountInput].style.left,10)-iImageExplosionEffectAnimationWidth/2;

		explosionEffectImage.style.top = parseInt(arrayPuzzleTileCountId[iTileBgCountInput].style.top,10)-iImageExplosionEffectAnimationHeight/2;
	}

  //added by Mike, 20231126
  function setMonsterExplosionEffectPosition(iInputX, iInputY) {
//    var explosionEffectImage = document.getElementById("explosionEffectImageId");
    var explosionEffectImage = document.getElementById("explosionEffectToMonsterImageId");

    //added by Mike, 20231126
    if (explosionEffectImage.style.visibility=="visible") {
      return;
    }
	
	//edited by Mike, 20231127
    //explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";
    explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";

    explosionEffectImage.style.visibility="visible";

    iMonsterExplosionEffectAnimationDelayCount=iMonsterExplosionEffectAnimationDelayCountMax;

    iMonsterExplosionEffectAnimationCount=-1; //0;

    explosionEffectImage.style.left = iInputX-iImageExplosionEffectAnimationWidth/2;

    explosionEffectImage.style.top = iInputY-iImageExplosionEffectAnimationHeight/2;
  }

  //added by Mike, 20231129
  function setCityExplosionEffectPosition(iInputX, iInputY) {
//    var explosionEffectImage = document.getElementById("explosionEffectImageId");
    var explosionEffectImage = document.getElementById("explosionEffectToCityImageId");

    //added by Mike, 20231126
    if (explosionEffectImage.style.visibility=="visible") {
      return;
    }
	
	//edited by Mike, 20231127
    //explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";
    explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";

    explosionEffectImage.style.visibility="visible";

    iMonsterExplosionEffectAnimationDelayCount=iMonsterExplosionEffectAnimationDelayCountMax;

    iMonsterExplosionEffectAnimationCount=-1; //0;

    explosionEffectImage.style.left = iInputX-iImageExplosionEffectAnimationWidth/2;

    explosionEffectImage.style.top = iInputY-iImageExplosionEffectAnimationHeight/2;
  }

	//added by Mike, 20240511
	function setDustEffectPosition(iInputX, iInputY) {
		var dustEffectImage = document.getElementById("dustEffectImageId");

		if (dustEffectImage.style.visibility=="visible") {
		  return;
		}

		dustEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";

		dustEffectImage.style.visibility="visible";

		iDustEffectAnimationDelayCount=iDustEffectAnimationDelayCountMax;

		iDustEffectAnimationCount=-1; //0;
/*
alert("iInputX: "+iInputX);
alert("iInputY: "+iInputY);
*/
		dustEffectImage.style.left = iInputX;//+iImageDustEffectAnimationWidth/2;
		dustEffectImage.style.top = iInputY+iImageDustEffectAnimationHeight/4; //near feet
	}
  
  	//added by Mike, 20231128
	function executeEnterClickAnimation() {	
		var textEnterDiv = document.getElementById("textEnterDivId");

			
		if (iTitlePressStartEffectDelayCount<iTitlePressStartEffectDelayCountMax) {
			iTitlePressStartEffectDelayCount++;
			return;	
		}
		else {
			iTitlePressStartEffectDelayCount=0;
		}
		
		//textEnterDiv.innerHTML = "START";
		//textEnterDiv.innerHTML = "<font color='red'>START</font>";

		//alert(iTransitionScale);
		
		if (iTransitionScale<1) {
			iTransitionScale+=0.1
		}
		else if (iTransitionScale>0) {
			iTransitionScale-=0.1
		}

		textEnterDiv.style.transform = "scale("+iTransitionScale+","+iTransitionScale+")";	
	}

	
	//added by Mike, 20231121
	function executeMouseClickAnimation() {
		var mouseInputImage = document.getElementById("mouseInputImageId");
    mouseInputImage.style.visibility="visible";

		if (iMouseAnimationDelayCount==iMouseAnimationDelayCountMax) {
			iMouseAnimationCount=(iMouseAnimationCount+1)%3; //last hidden


			iMouseAnimationDelayCount=0;
			/*
			explosionEffectImage.style.visibility="visible";
			*/
			
			//setMonsterExplosionEffectPosition(parseInt(titleImage.style.left)+iTitleImageWidth*0.15,parseInt(titleImage.style.top)+iTitleImageHeight/2);
		}
		else {
			iMouseAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

	    //iImageFrameWidth*2; inputImageLarge

		if (iMouseAnimationCount==0) { 
			mouseInputImage.style.objectPosition = "-" + 0 + "px -" + 192 + "px";
		}
		else if (iMouseAnimationCount==1) { 
			mouseInputImage.style.objectPosition = "-" + (iImageFrameWidth*2) + "px -" + 192 + "px";
		}
		else {
			mouseInputImage.style.objectPosition = "-" + (iImageFrameWidth*2)*2 + "px -" + 192 + "px";
		}
	}
	
	//added by Mike, 20241103
	function executeHeroWalkingAnimation() {
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");
		mainImageTileHeroBody.style.visibility="visible";

		if (iHeroAnimationDelayCount==iHeroAnimationDelayCountMax) {
			iHeroAnimationCount=(iHeroAnimationCount+1)%3; //last hidden

			iHeroAnimationDelayCount=0;
		}
		else {
			iHeroAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		var iFrameY=0;
		//destination to the left of hero projectile
		//if (newMainImageTileProjectilePosX<0) {
		if (bIsHeroFacingLeft) {
			iFrameY=iImageFrameHeight*2;//64*2; 128;
		}
		else {
			iFrameY=iImageFrameHeight*3;//64*3; 192;
		}

		if (iHeroAnimationCount==0) { 
			mainImageTileHeroBody.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (iHeroAnimationCount==1) { 
			mainImageTileHeroBody.style.objectPosition = "-" + iImageFrameWidth + "px -" + iFrameY + "px";
		}
		else {
			mainImageTileHeroBody.style.objectPosition = "-" + iImageFrameWidth*2 + "px -" + iFrameY + "px";
		}
	}
	
	function executeTankWalkingAnimation() {
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		mainImageTileTankBody.style.visibility="visible";

		if (iHeroAnimationDelayCount==iHeroAnimationDelayCountMax) {
			iHeroAnimationCount=(iHeroAnimationCount+1)%3; //last hidden

			iHeroAnimationDelayCount=0;
		}
		else {
			iHeroAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		var iFrameY=0;
		//destination to the left of hero projectile
		//if (newMainImageTileProjectilePosX<0) {
		if (bIsHeroFacingLeft) {
			iFrameY=iImageFrameHeightLarge*2;//64*2; 128;
		}
		else {
			iFrameY=iImageFrameHeightLarge*3;//64*3; 192;
		}
		
		if (iHeroAnimationCount==0) { 
			mainImageTileTankBody.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (iHeroAnimationCount==1) { 
			mainImageTileTankBody.style.objectPosition = "-" + iImageFrameWidthLarge + "px -" + iFrameY + "px";
		}
		else {
			mainImageTileTankBody.style.objectPosition = "-" + iImageFrameWidthLarge*2 + "px -" + iFrameY + "px";
		}
	}	

	function executeMonsterWalkingAnimation() {
		var batMonsterImageTile = document.getElementById("batMonsterImageId");
		var mainImageTile = document.getElementById("mainImageTileImageId");

		batMonsterImageTile.style.visibility="visible";

		//iMonsterAnimationDelayCountMax=15;

		//alert(mainImageTile.style.left);
		
		if (iMonsterAnimationDelayCount>=iMonsterAnimationDelayCountMax) {
			iMonsterAnimationCount=(iMonsterAnimationCount+1)%2; //3; //last hidden

			iMonsterAnimationDelayCount=0;			
			
			//==============================
			//AI; movement
			if (batMonsterTileStepDelay>=batMonsterTileStepDelayMax) {
				batMonsterTileStepDelay=0;

				if (batMonsterImageTilePosY<parseInt(mainImageTile.style.top)) {//mainImageTilePosY) {
					batMonsterImageTilePosY+=batMonsterTileStepY;				
				}
				else {
					batMonsterImageTilePosY-=batMonsterTileStepY;
				}
				
				batMonsterImageTile.style.top=batMonsterImageTilePosY+"px";

				if (batMonsterImageTilePosX<mainImageTilePosX) {
					batMonsterImageTilePosX+=batMonsterTileStepX;
				}
				else {
					batMonsterImageTilePosX-=batMonsterTileStepX;
				}
				
				batMonsterImageTile.style.left=batMonsterImageTilePosX+"px";							
			}
			else {
				batMonsterTileStepDelay++;
			}			
			//==============================
		}
		else {
			iMonsterAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		//var iFrameY=0;
		var iFrameY=iImageFrameHeight*2;//64*2; 128;

/*		
		//destination to the left of hero projectile
		//if (newMainImageTileProjectilePosX<0) {
		if (bIsHeroFacingLeft) {
			iFrameY=iImageFrameHeight*2;//64*2; 128;
		}
		else {
			iFrameY=iImageFrameHeight*3;//64*3; 192;
		}
*/
		//currently two frames only
		if (iMonsterAnimationCount==0) { 
			batMonsterImageTile.style.objectPosition = "-" + 0 + "px -" + iFrameY + "px";
		}
		else if (iMonsterAnimationCount==1) { 
			batMonsterImageTile.style.objectPosition = "-" + iImageFrameWidthDefault + "px -" + iFrameY + "px";
		}
/*		
		else {
			batMonsterImageTile.style.objectPosition = "-" + iImageFrameWidthDefault*2 + "px -" + iFrameY + "px";
		}
*/		
	}
	
	
	function executeExplosionEffect() {
		var explosionEffectImage = document.getElementById("explosionEffectImageId");

		if (explosionEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iExplosionEffectAnimationDelayCount==iExplosionEffectAnimationDelayCountMax) {
	//	if (iExplosionEffectAnimationDelayCount>=iExplosionEffectAnimationDelayCountMax) {
			iExplosionEffectAnimationCount=(iExplosionEffectAnimationCount+1)%5; //last hidden


			iExplosionEffectAnimationDelayCount=0;
			/*
			explosionEffectImage.style.visibility="visible";
			*/
		}
		else {
			iExplosionEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		if (iExplosionEffectAnimationCount==0) { //%2
			explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 0 + "px";
		}
		else if (iExplosionEffectAnimationCount==1) {
			explosionEffectImage.style.objectPosition = "-" + 128 + "px -" + 0 + "px";
			//alert(">>>>");
		}
		else if (iExplosionEffectAnimationCount==2) {
			explosionEffectImage.style.objectPosition = "-" + 128*2 + "px -" + 0 + "px";
			//alert(">>>>");
		}
		else if (iExplosionEffectAnimationCount==3) {
			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + 0 + "px";
			//alert(">>>>");
		}
		else {
			explosionEffectImage.style.visibility="hidden";
		}
	}


  function executeExplosionEffectToMonsterBoss() {
		var explosionEffectImage = document.getElementById("explosionEffectToMonsterImageId");

		if (explosionEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iMonsterExplosionEffectAnimationDelayCount==iMonsterExplosionEffectAnimationDelayCountMax) {
	//	if (iExplosionEffectAnimationDelayCount>=iExplosionEffectAnimationDelayCountMax) {
			iMonsterExplosionEffectAnimationCount=(iMonsterExplosionEffectAnimationCount+1)%5; //last hidden


			iMonsterExplosionEffectAnimationDelayCount=0;
			/*
			explosionEffectImage.style.visibility="visible";
			*/
		}
		else {
			iMonsterExplosionEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		if (iMonsterExplosionEffectAnimationCount==0) { //%2
			explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";
		}
		else if (iMonsterExplosionEffectAnimationCount==1) {
			explosionEffectImage.style.objectPosition = "-" + 128 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else if (iMonsterExplosionEffectAnimationCount==2) {
			explosionEffectImage.style.objectPosition = "-" + 128*2 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else if (iMonsterExplosionEffectAnimationCount==3) {
			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else {
			explosionEffectImage.style.visibility="hidden";
			//added by Mike, 20231128
			//iTitleExplosionEffectDelayCount=0;
		}
	}

	function executeExplosionEffectToCity() {
		var explosionEffectImage = document.getElementById("explosionEffectToCityImageId");

/*		
		if (iTransitionScale<1) {
			iTransitionScale+=0.1
		}
		else if (iTransitionScale>0) {
			iTransitionScale-=0.1
		}
*/
		//iTransitionScale=0.5;
		
//		explosionEffectImage.style.transform = "scale("+iTransitionScale+","+iTransitionScale+")";	

		//explosionEffectImage.style.transform = "scale("+0.5+","+0.5+")";	

		if (explosionEffectImage.style.visibility=="hidden") {
			return;
		}

		//alert("Dito");
		
		if (iMonsterExplosionEffectAnimationDelayCount==iMonsterExplosionEffectAnimationDelayCountMax) {
	//	if (iExplosionEffectAnimationDelayCount>=iExplosionEffectAnimationDelayCountMax) {
			iMonsterExplosionEffectAnimationCount=(iMonsterExplosionEffectAnimationCount+1)%5; //last hidden


			iMonsterExplosionEffectAnimationDelayCount=0;
			/*
			explosionEffectImage.style.visibility="visible";
			*/
		}
		else {
			iMonsterExplosionEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		}

		//alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);

		if (iMonsterExplosionEffectAnimationCount==0) { //%2
			explosionEffectImage.style.objectPosition = "-" + 0 + "px -" + 128 + "px";
		}
		else if (iMonsterExplosionEffectAnimationCount==1) {
			explosionEffectImage.style.objectPosition = "-" + 128 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else if (iMonsterExplosionEffectAnimationCount==2) {
			explosionEffectImage.style.objectPosition = "-" + 128*2 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else if (iMonsterExplosionEffectAnimationCount==3) {
			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + 128 + "px";
			//alert(">>>>");
		}
		else {
			explosionEffectImage.style.visibility="hidden";
			//added by Mike, 20231128
			//iTitleExplosionEffectDelayCount=0;
		}
	}

	//added by Mike, 20241105
	function executeDustEffect() {
		var dustEffectImage = document.getElementById("dustEffectImageId");

		if (dustEffectImage.style.visibility=="hidden") {
			return;
		}

		if (iDustEffectAnimationDelayCount==iDustEffectAnimationDelayCountMax) {
			iDustEffectAnimationCount=(iDustEffectAnimationCount+1)%4;//5; //last hidden

			iDustEffectAnimationDelayCount=0;
		}
		else {
			iDustEffectAnimationDelayCount++;

	//		alert("iExplosionEffectAnimationCount: "+iExplosionEffectAnimationCount);
		}
		
		//dustEffectImage.style.objectPosition = "-" + 0 + "px -" + 256 + "px";

		//alert("iDustEffectAnimationCount: "+iDustEffectAnimationCount);

		if (iDustEffectAnimationCount==0) { //%2
			dustEffectImage.style.objectPosition = "-" + 0 + "px -" + 256 + "px";
		}
		else if (iDustEffectAnimationCount==1) {
			dustEffectImage.style.objectPosition = "-" + iImageDustEffectAnimationWidth + "px -" + 256 + "px";
			//alert(">>>>");
		}
		else if (iDustEffectAnimationCount==2) {
			dustEffectImage.style.objectPosition = "-" + iImageDustEffectAnimationWidth*2 + "px -" + 256 + "px";
			//alert(">>>>");
		}
////		else if (iExplosionEffectAnimationCount==3) {
////			explosionEffectImage.style.objectPosition = "-" + 128*3 + "px -" + 0 + "px";
////			//alert(">>>>");
////		}	
		else {
			dustEffectImage.style.visibility="hidden";
		}		
	}
	
	//added by Mike, 20231127
	function resetTransitionEffect() {						
		var myDivTransitionEffect = document.getElementById("divTransitionEffectId");
		
		iTransitionScale=0; //0.00005;
		iTransitionRotate=0;
		iTransitionDelayCount=0;
		
		//added by Mike, 20231128
		iTransitionFromPuzzleToBossDelayCount=0;
				
		myDivTransitionEffect.style.transform = "rotate("+iTransitionRotate+"deg)"+" scale("+iTransitionScale+","+iTransitionScale+")";	
				
		myDivTransitionEffect.style.visibility="visible";
		
		bIsExecutingTransition=true;
		bIsTransitionFirstPartDone=false;
		
		//alert("HALLO!!");
	}

	function executeTransitionEffect() {

		bIsTransitionFirstPartDone=true;				
		iTransitionDelayCount=0;
		
		var howToPlayGuideImage = document.getElementById("howToPlayGuideImageId");

		var howToPlayGuideImageFrame2 = document.getElementById("howToPlayGuideImageFrame2Id");

		howToPlayGuideImage.style.visibility = "hidden";
		howToPlayGuideImageFrame2.style.visibility = "hidden";
		
		  if (!bIsBossBattleDone) {					

			var mainImageMonster = document.getElementById("mainImageMonster0");
			var textScoreDiv = document.getElementById("textScoreDivId");
			var myCanvasTwo = document.getElementById("myCanvasTwoId");
			var mainImageTile = document.getElementById("mainImageTileImageId");
			var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
			var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

			//added by Mike, 20231129
			var bossBattleBgImage = document.getElementById("bossBattleBgImageId");			

			//added by Mike, 20231129
			var bossBattleBgImagePart2 = document.getElementById("bossBattleBgImagePart2Id");		
			var mainImageSoldier = document.getElementById("mainImageSoldierId");			
									
			mainImageSoldier.style.visibility = "hidden";
			 
			mainImageMonster.style.visibility = "hidden";
			textScoreDivId.style.color="white";
			myCanvasTwo.style.visibility="visible";
									
			//edited by Mike, 20241103
			//mainImageTile.style.visibility = "visible";
			mainImageTile.style.visibility = "hidden";

			if (bIsHeroInTank) {
				mainImageTileTankBody.style.visibility = "visible";			
			}
			else {
				mainImageTileHeroBody.style.visibility = "visible";
			}
			
			bossBattleBgImage.style.visibility = "visible";
			bossBattleBgImagePart2.style.visibility = "visible";
			
			bossBattleBgImagePart2.style.left = 0+"px"; 
			
			bossBattleBgImagePart2.style.top = 0+iStageMaxHeight-bossBattleBgImagePart2.clientHeight+"px";

			
			//added by Mike, 20231129
			//setCityExplosionEffectPosition(0,0);
			//setCityExplosionEffectPosition(parseInt(bossBattleBgImage.style.left)+bossBattleBgImage.clientWidth*0.3,parseInt(bossBattleBgImage.style.top)+bossBattleBgImage.clientHeight/2);
			
			setCityExplosionEffectPosition(parseInt(bossBattleBgImage.style.left)+bossBattleBgImage.clientWidth*0.1,parseInt(bossBattleBgImage.style.top)+bossBattleBgImage.clientHeight/3);

			//setCityExplosionEffectPosition(0,parseInt(bossBattleBgImage.style.top)+bossBattleBgImage.clientHeight/5);
		  }
	}
	
	function initMapLocation() {
		
	}

	function heroHitByMonster(mainImageTilePosX, mainImageTilePosY, iMonsterImageTilePosX, iMonsterImageTilePosY) {	
		
		
		//bIsHeroAttacked=true;
		
		
	
/*	
		mainImageTileProjectilePosX=mainImageTileProjectileStepDestinationX-iImageFrameWidth/2;
		bHasReachedDestinationX=true;
*/		
		//alert(">>>>>mainImageTilePosY: "+mainImageTilePosY);
		
		//alert(">>>>>iMonsterImageTilePosY: "+iMonsterImageTilePosY);
		
/*		
		mainImageTileProjectilePosX = mainImageTile.style.left;
		mainImageTileProjectilePosY = mainImageTile.style.top;
*/

/*	
		alert ("mainImageTileProjectileStepDestinationX: "+mainImageTileProjectileStepDestinationX);

		alert ("mainImageTileProjectileStepDestinationY: "+mainImageTileProjectileStepDestinationY);

		//push to the opposite direction
		//monster is to the left of hero
		if (iMonsterImageTilePosX+iImageFrameWidthDefault<mainImageTilePosX) {
			mainImageTileProjectilePosX=iMonsterImageTilePosX+iImageFrameWidthDefault+mainImageTileStepX*5;
			
			mainImageTilePosX=mainImageTileProjectilePosX;
		}
		//monster is to the right of hero		
		//hero's iImageFrameWidth
		else { //if (iMonsterImageTilePosX>=mainImageTilePosX+iImageFrameWidth) {				
			mainImageTileProjectilePosX=iMonsterImageTilePosX-mainImageTileStepX*5-iImageFrameWidth;
			
			mainImageTilePosX=mainImageTileProjectilePosX;
		}

		//monster is to the top of hero
		if (iMonsterImageTilePosY+iImageFrameHeightDefault<mainImageTilePosY) {		
			//alert("mainImageTilePosY: "+mainImageTilePosY);

			mainImageTileProjectilePosY=iMonsterImageTilePosY+iImageFrameHeightDefault+mainImageTileStepY*5;
			
			mainImageTilePosY=mainImageTileProjectilePosY;			
			
			//alert("mainImageTilePosY: "+mainImageTilePosY);			
		}
		//monster is to the bottom of hero		
		//hero's iImageFrameHeight
		else { //if (iMonsterImageTilePosY>=mainImageTilePosY+iImageFrameHeight) {	
			mainImageTileProjectilePosY=iMonsterImageTilePosY-mainImageTileStepY*5-iImageFrameHeight;
						
			mainImageTilePosY=mainImageTileProjectilePosY;
		}
*/		

		resetProjectile();	
/*		
		mainImageTileProjectileStepDestinationX=mainImageTileProjectileStepDestinationX*(-1);		
		mainImageTileProjectileStepDestinationY=mainImageTileProjectileStepDestinationY*(-1);
*/		
		
/*		
		//mainImageTilePosX-=mainImageTileStepX; //horizontal movement;
		mainImageTilePosY+=mainImageTileStepY*10; //vertical movement;
		
		//mainImageTile.style.left=mainImageTilePosX+"px";
		mainImageTile.style.top=mainImageTilePosY+"px";
*/
		
/*
		mainImageTileProjectileStepDestinationX=mainImageTileProjectileStepDestinationX*(-1);		
		mainImageTileProjectileStepDestinationY=mainImageTileProjectileStepDestinationY*(-1);
		

		mainImageTileProjectilePosX=parseInt(mainImageTileProjectilePosX)+newMainImageTileProjectilePosX;

		mainImageTileProjectilePosX=mainImageTileProjectilePosX*(-1);

		mainImageTileProjectilePosY=parseInt(mainImageTileProjectilePosY)+newMainImageTileProjectilePosY;

		mainImageTileProjectilePosY=mainImageTileProjectilePosY*(-1);

		//mainImageTileProjectilePosY=iMonsterImageTilePosY-mainImageTileStepY*5-iImageFrameHeight;
		
		mainImageTilePosX=mainImageTileProjectilePosX;
						
		mainImageTilePosY=mainImageTileProjectilePosY;
*/			
		
		//alert("mainImageTileProjectileStepDestinationY: "+mainImageTileProjectileStepDestinationY);

/*
		alert("mainImageTileProjectilePosY: "+mainImageTileProjectilePosY);
*/				
		
/*		
		mainImageTileProjectilePosY=iMonsterImageTilePosY+iImageFrameHeightDefault+mainImageTileStepY*5;
		
		mainImageTileProjectileStepDestinationY=mainImageTileProjectilePosY;

		mainImageTilePosY=mainImageTileProjectilePosY;			
*/
			
/*			
		
		//push to the opposite direction
		//monster is to the left of hero
		if (iMonsterImageTilePosX+iImageFrameWidthDefault<=mainImageTilePosX) {
			mainImageTileProjectilePosX=iMonsterImageTilePosX+iImageFrameWidthDefault+mainImageTileStepX*5;
			
			mainImageTileProjectileStepDestinationX=mainImageTileProjectilePosX;
			
			mainImageTilePosX=mainImageTileProjectilePosX;
		}
		//monster is to the right of hero		
		//hero's iImageFrameWidth
		else if (iMonsterImageTilePosX>=mainImageTilePosX+iImageFrameWidth) {				
			mainImageTileProjectilePosX=iMonsterImageTilePosX-mainImageTileStepX*5-iImageFrameWidth;
			
			mainImageTileProjectileStepDestinationX=mainImageTileProjectilePosX;
			
			mainImageTilePosX=mainImageTileProjectilePosX;
		}

		//monster is to the top of hero
		if (iMonsterImageTilePosY+iImageFrameHeightDefault<=mainImageTilePosY) {		
			//alert("mainImageTilePosY: "+mainImageTilePosY);

			mainImageTileProjectilePosY=iMonsterImageTilePosY+iImageFrameHeightDefault+mainImageTileStepY*5;
			
			mainImageTileProjectileStepDestinationY=mainImageTileProjectilePosY;

			mainImageTilePosY=mainImageTileProjectilePosY;			
			
			//alert("mainImageTilePosY: "+mainImageTilePosY);			
		}
		//monster is to the bottom of hero		
		//hero's iImageFrameHeight
		else if (iMonsterImageTilePosY>=mainImageTilePosY+iImageFrameHeight) {	
			mainImageTileProjectilePosY=iMonsterImageTilePosY-mainImageTileStepY*5-iImageFrameHeight;
			
			mainImageTileProjectileStepDestinationY=mainImageTileProjectilePosY;
			
			mainImageTilePosY=mainImageTileProjectilePosY;
		}
*/
		

/*
		//if (!bHasReachedDestinationX) {
			if (newMainImageTileProjectilePosX<0) {
				if (mainImageTileProjectilePosX+iImageFrameWidth/2<=mainImageTileProjectileStepDestinationX) {
						
				  mainImageTileProjectilePosX=mainImageTileProjectileStepDestinationX-iImageFrameWidth/2;
				  bHasReachedDestinationX=true;
				  //resetProjectile();
				}
				else {
				  bHasReachedDestinationX=false;
				}
			}
			//destination to the right of hero projectile
			else {
				if (mainImageTileProjectilePosX+iImageFrameWidth/2>=mainImageTileProjectileStepDestinationX) {
					mainImageTileProjectilePosX=mainImageTileProjectileStepDestinationX-iImageFrameWidth/2;
					bHasReachedDestinationX=true;
					//resetProjectile();
				}		
				else {
				  bHasReachedDestinationX=false;
				}				
			}
		//}
		
		//if (!bHasReachedDestinationY) {		
			//destination to the top of hero projectile
			if (newMainImageTileProjectilePosY<0) {
				if (mainImageTileProjectilePosY+iImageFrameHeight/2<=mainImageTileProjectileStepDestinationY) {
										
				mainImageTileProjectilePosY=mainImageTileProjectileStepDestinationY-iImageFrameHeight/2;
				bHasReachedDestinationY=true;
				//resetProjectile();
				}
				else {
				  bHasReachedDestinationY=false;
				}				
			}
			//destination to the bottom of hero projectile
			else {
				if (mainImageTileProjectilePosY+iImageFrameHeight/2>=mainImageTileProjectileStepDestinationY) {
					mainImageTileProjectilePosY=mainImageTileProjectileStepDestinationY-iImageFrameHeight/2;
					bHasReachedDestinationY=true;
					//resetProjectile();
				}			
				else {
				  bHasReachedDestinationY=false;
				}								
			}			
		//}
*/		
		
/*		
		bHasReachedDestinationX=true;
		bHasReachedDestinationY=true;
*/		

		//mainImageTileProjectileStepDestinationX=mainImageTileProjectilePosX;
		//mainImageTileProjectileStepDestinationY=mainImageTileProjectilePosY;	


/*
		var mainImageTile = document.getElementById("mainImageTileImageId");		
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");
		
		mainImageTile.style.left=mainImageTilePosX+"px";
		mainImageTile.style.top=mainImageTilePosY+"px";
		
		mainImageTileHeroBody.style.left = mainImageTile.style.left;
		mainImageTileHeroBody.style.top = mainImageTile.style.top;
*/		

/*		
		mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
*/						
/*								

		mainImageTilePosY=0;//+iStageMaxHeight-iInnerVerticalOffset*2-iImageFrameHeightDefault;
						
		mainImageTilePosX=500;//iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
*/
				
//mainImageTilePosY=500;
				
		//mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
				
		//alert(">>>>>mainImageTilePosY: "+mainImageTilePosY);
		
		//resetProjectile();
		
		//return true;
	}
	
	function verifyHeroCollideWithMonsters() {
		var batMonsterImageTile = document.getElementById("batMonsterImageId");
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");
		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");	

		if (!isBatMonsterTileActive) {
			return;
		}		
		//if (batMonsterImageTile.style.visibility!=="hidden") {						
		else { //if (isBatMonsterTileActive) {						

			if (bIsHeroAttacked) {
				//bIsHeroAttacked=false;
				return;
			}
			
			//bIsHeroAttacked=false;		

			//+iImageFrameWidthDefault/2; iImageFrameHeightDefault/2
			if (isPointsOfRectIntersectingPointsOfRectMonster(mainImageTilePosX,mainImageTilePosY, batMonsterImageTilePosX,batMonsterImageTilePosY, iImageFrameWidth, iImageFrameHeight, iImageFrameWidthDefault, iImageFrameHeightDefault)) {			
				//alert("HALLO"); 	
			
				bIsHeroAttacked=true;
				bIsExecutingShake=true;

				//Usbong SFZ
				//TODO: -add: hitBy(...)
				heroHitByMonster(mainImageTilePosX,mainImageTilePosY, batMonsterImageTilePosX,batMonsterImageTilePosY);
				
				//batMonsterImageTile.style.visibility="hidden";
				
				//isBatMonsterTileActive=false;
/*				
				if (bIsHeroInTank) {
					mainImageTileTankBody.style.visibility="hidden";				
				}
				else {
					mainImageTileHeroBody.style.visibility="hidden";
				}				
*/				
			}
/*			
			else {
				if (bIsHeroAttacked) {
					//alert("DITO");
				}
				bIsHeroAttacked=false;		
			}
*/			
		}
	}
	
	function myUpdateFunction() {
//    alert(window.getfullscreen());

/*
    //alert(window.getfullscreen);
    if (window.getfullscreen!=undefined) {
      alert(window.getfullscreen);
    }
*/
   //alert(screen.width);
/*
   if (screen.width!==1280) {
     alert(screen.width);
   }
*/

//iHorizontalOffset=(screen.width-iStageMaxWidth)/2;
//using square for main dungeon
iHorizontalOffset=(640-iStageMaxHeight)/2;


//iHorizontalOffset=0;


		var mainImageTile = document.getElementById("mainImageTileImageId");

		//added by Mike, 20231124
		var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");

		var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

		//added by Mike, 20230427
		var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");
		
		//added by Mike, 20231128
		var bossBattleBgImage = document.getElementById("bossBattleBgImageId");


    //added by Mike, 20231125
    var mainImageMonsterBoss = document.getElementById("mainImageMonsterBoss");
    var mainImageMonster = document.getElementById("mainImageMonster0");


		var batMonsterImageTile = document.getElementById("batMonsterImageId");


	//added by Mike, 20231129
	 var mainImageSoldier = document.getElementById("mainImageSoldierId");

    	//added by Mike, 20231124
    	var puzzleTileImageTargetBorder = document.getElementById("divPuzzleTileImageTargetBorderId");

		//added by Mike, 20231111
		var puzzleTileImageSpaceBorder = document.getElementById("divPuzzleTileImageSpaceBorderId");

		var textStatusDiv = document.getElementById("textStatusDivId");
		var textStatusBackgroundDiv = document.getElementById("textStatusBackgroundDivId");

		var textEnterDiv = document.getElementById("textEnterDivId");

		//added by Mike, 20231119
		var explosionEffectImage = document.getElementById("explosionEffectImageId");
    //added by Mike, 20231126
    var explosionEffectToMonsterImage = document.getElementById("explosionEffectToMonsterImageId");


		//added by Mike, 20231121
		var mouseInputImage = document.getElementById("mouseInputImageId");

		//added by Mike, 20231121
		var titleImage = document.getElementById("titleImageId");
		//titleImage.style.visibility="hidden";

		//added by Mike, 20231122
		var howToPlayGuideImage = document.getElementById("howToPlayGuideImageId");

		//added by Mike, 20231129
		var howToPlayGuideImageFrame2 = document.getElementById("howToPlayGuideImageFrame2Id");


		//added by Mike, 20231123
//		if (iScore<iTargetScore) {
    //edited by Mike, 20231124
    if (bIsIncreasingScore) {
  		if (iScore<(iTargetScore-77)) {
  			iScore+=77;
  		}
  		else {
  			iScore=iTargetScore;
  		}
    }
    else {
/*
      alert("iScore: "+iScore);
      alert("iTargetScore: "+iTargetScore);
*/
      if (iScore>(iTargetScore+77)) {
  			iScore-=77;
  		}
  		else {
  			iScore=iTargetScore;
  		}
    }

		if (iScore>999999) {
			iScore=999999;
		}
    else if (iScore<=0) {
      //END; BATTLE FAIL
      iScore=0;
    }

		var textScoreDiv = document.getElementById("textScoreDivId");

		//note: correct sequence to cause correct OUTPUT
		textScoreDiv.innerHTML = iScore;

//		var iTextScoreDivWidthOffset=5;
		iTextScoreDivWidth = (textScoreDiv.clientWidth)+iTextScoreDivWidthOffset;

		//added by Mike, 20231125
		var textScoreShadowDiv = document.getElementById("textScoreShadowDivId");
		textScoreShadowDiv.innerHTML = iScore;

		//textScoreShadowDiv.style.left = textScoreDiv.style.left;
		textScoreShadowDiv.style.left = parseInt(textScoreDiv.style.left)+iTextScoreShadowDivWidthOffset +"px";


    //added by Mike, 20230313
    //reference: https://www.w3schools.com/tags/canvas_fillrect.asp;
    //last accessed: 2020911
    var myCanvas = document.getElementById("myCanvasId");
    var myCanvasContext = myCanvas.getContext("2d");
    //myCanvasContext.clearRect(0, 0, iStageMaxWidth, iStageMaxHeight)

    myCanvasContext.fillStyle = "#f3f3f3"; //"#f9f9f9"; //"#f3f3f3"; //"#ffffff"; //white background//stage
    myCanvasContext.fillRect(0, 0, iStageMaxWidth, iStageMaxHeight);


    //added by Mike, 20231126
    var myCanvasTwo = document.getElementById("myCanvasTwoId");
    var myCanvasTwoContext = myCanvasTwo.getContext("2d");
    //myCanvasContext.clearRect(0, 0, iStageMaxWidth, iStageMaxHeight)

    //edited by Mike, 20231126
    //myCanvasTwoContext.fillStyle = "#000000"; //"#ffffff"; //white background//stage

    //reference#1: https://www.w3schools.com/jsref/canvas_createlineargradient.asp;
    //last accessed: 20231126
    //reference#2: https://www.tumblr.com/yes-asil; last accessed: 20231126

    // Create a Gradient
//    const grd = myCanvasTwoContext.createLinearGradient(0, 60, 0, 170);
    const grd = myCanvasTwoContext.createLinearGradient(0, 20, 0, 170);

  grd.addColorStop(0, "#002244");
  grd.addColorStop(1, "#00aacc");

    // Draw a filled Rectangle
    myCanvasTwoContext.fillStyle = grd;

    //note: max is 150 for height?...
    myCanvasTwoContext.fillRect(0, 0, iStageMaxWidth, 120);//iStageMaxHeight/2);

	
	//iCurrSnowFlakeCountMax
	for (iCurrSnowFlakeCount=0; iCurrSnowFlakeCount<10; iCurrSnowFlakeCount++) {
	
		var myDivSnowEffect = document.getElementById("divSnowEffectId"+iCurrSnowFlakeCount);
	
/*		
		var iCurrSnowFlakeCountPosX=0;
		var iCurrSnowFlakeCountPosY=0;
*/
		iCurrSnowFlakeCountPosX=window.parseInt(Math.random() * iStageMaxWidth)%iStageMaxWidth;

		iCurrSnowFlakeCountPosY=window.parseInt(Math.random() * iStageMaxHeight)%iStageMaxHeight;

		myDivSnowEffect.style.left=iCurrSnowFlakeCountPosX+iHorizontalOffset+"px";
		myDivSnowEffect.style.top=iCurrSnowFlakeCountPosY+iVerticalOffsetInnerScreen+"px";	

		myDivSnowEffect.style.visibility="visibility";		
	}
	
	//added by Mike, 20231128
	bossBattleBgImage.style.left=0+iHorizontalOffset+"px";
	//bossBattleBgImage.style.top=0+iVerticalOffsetInnerScreen+iStageMaxHeight*0.2+"px";	
	bossBattleBgImage.style.top=0+iVerticalOffsetInnerScreen+"px";	

	

	if (bIsExecutingShake) {
		iShakeOffsetWidth=iShakeOffsetWidthMax;
		iShakeOffsetHeight=iShakeOffsetHeightMax;

		//alert("dito");

		if (iDestroyHumanShakeDelayCount==iDestroyHumanShakeDelayMax) {
			//myKeysDown[KEY_K] = FALSE;
    		bIsExecutingShake = false;
    		iDestroyHumanShakeDelayCount=0;
			
			//bIsHeroAttacked=false;
    	}
    	else {
				iDestroyHumanShakeDelayCount+=1;
    	}
	}
	else {
  			iShakeOffsetWidth=0;
			iShakeOffsetHeight=0;
	}


	myCanvas.style.top = (iVerticalOffsetInnerScreen+0)+iShakeOffsetHeight+"px";
/*
  if (bIsStillUsingItchScreen) {
    iHorizontalOffset=0;
    myCanvas.style.left=iHorizontalOffset+"px";
  }
  else {
    iHorizontalOffset=(screen.width)/2-iStageMaxWidth/2;
    myCanvas.style.left=iHorizontalOffset+"px";
  }
*/

  iHorizontalOffset=myCanvas.getBoundingClientRect().x+iShakeOffsetWidth;


/*  //removed by Mike, 20231126; itch.io
  //edited by Mike, 20231126
  //iHorizontalOffset=myCanvas.getBoundingClientRect().x+iShakeOffsetWidth;
  //note: for INNER SCREEN
	iHorizontalOffset=(screen.width)/2-iStageMaxWidth/2+iShakeOffsetWidth;
  myCanvas.style.left = iHorizontalOffset+"px";
*/
//  myCanvas.style.left = iHorizontalOffset+"px";

  //added by Mike, 20231126
  myCanvasTwo.style.top = myCanvas.style.top;
  myCanvasTwo.style.left = myCanvas.style.left;


		textScoreDiv.style.left = iHorizontalOffset+iStageMaxWidth-iTextScoreDivWidth+"px";
		textScoreDiv.style.top= (0)+"px";

		//edited by Mike, 20230423; from 20230321
		mainImageTile.style.clip = "rect(0px "+iImageFrameWidth+"px "+iImageFrameHeight+"px 0px)";

		//added by Mike, 20230427
//		mainImageTileProjectile.style.clip = "rect("+iImageFrameWidth*2+"px "+iImageFrameWidth+"px "+iImageFrameHeight+"px "+iImageFrameWidth*2+"px)";

		mainImageTileProjectile.style.clip = "rect(0px "+iImageFrameWidth+"px "+iImageFrameHeight+"px 0px)";

//reference: https://developer.mozilla.org/en-US/docs/Web/CSS/transform-origin; last accessed: 20230424
//note: transform rotate uses whole unclipped image size; 256x256px
//25%/2 = 12.5%
mainImageTile.style.transformOrigin = "12.5% 12.5%";



		//added by Mike, 20231121
		if (!bHasViewedTitle) {
			titleImage.style.visibility="visible";
			
			mainImageMonster.style.visibility = "visible";

			//added by Mike, 20231121
			executeMouseClickAnimation();
			
			//added by Mike, 20231128
			explosionEffectImage = document.getElementById("explosionEffectToMonsterImageId");
	
			//added by Mike, 20231129
			explosionEffectToCityImage = document.getElementById("explosionEffectToCityImageId");	
	
			executeEnterClickAnimation();
			
if (explosionEffectImage.style.visibility=="hidden") {
	if (iTitleExplosionEffectDelayCount<iTitleExplosionEffectDelayCountMax) {				
		iTitleExplosionEffectDelayCount++;
	}
	else {	
		//alert("HERE!!!: "+iTitleExplosionEffectDelayCount);
		
		var titleImage = document.getElementById("titleImageId");

		var iTitleImageWidth = (titleImage.clientWidth);
		var iTitleImageHeight = (titleImage.clientHeight);

		//remove this; otherwise, error in output
		//explosionEffectImage.style.visibility="visible";	
		
//		setMonsterExplosionEffectPosition(parseInt(titleImage.style.left)+iTitleImageWidth*0.15,parseInt(titleImage.style.top)+iTitleImageHeight/2);
	
	
		setMonsterExplosionEffectPosition(parseInt(titleImage.style.left)+iTitleImageWidth*0.15,parseInt(titleImage.style.top)+iTitleImageHeight/3);
	
		
		iTitleExplosionEffectDelayCount=0;
	}
}

			
		}

		if (bHasPressedStart) {
			
			titleImage.style.visibility="hidden";
			bHasViewedTitle=true;

			textEnterDiv.style.visibility="hidden";

			
			if (!bHasViewedHowToPlayGuide) {
				//added by Mike, 20231122
				//var mouseInputImage = document.getElementById("mouseInputImageId");

				mouseInputImage.style.visibility="hidden";

				howToPlayGuideImage.style.visibility = "visible";
				
				//added by Mike, 20231129
				//howToPlayGuideImageFrame2.style.visibility = "visible";

				if (ihowToPlayGuideImageFrame2DelayCount<ihowToPlayGuideImageFrame2DelayCountMax) {
					ihowToPlayGuideImageFrame2DelayCount++;
				}
				else {
					ihowToPlayGuideImageFrame2DelayCount=0;

					if (howToPlayGuideImageFrame2.style.visibility == "visible") {
						howToPlayGuideImageFrame2.style.visibility = "hidden";
					}
					else {
						howToPlayGuideImageFrame2.style.visibility = "visible";
					}
				}
				
				var iHowToPlayGuideImageWidth = (howToPlayGuideImage.clientWidth);

				var iHowToPlayGuideImageHeight = (howToPlayGuideImage.clientHeight);

				howToPlayGuideImage.style.top = (iVerticalOffsetInnerScreen+0+iStageMaxHeight/2 -iHowToPlayGuideImageHeight/2)+"px";

				howToPlayGuideImage.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iHowToPlayGuideImageWidth/2 +"px";

				//added by Mike, 20231129
				howToPlayGuideImageFrame2.style.top = howToPlayGuideImage.style.top;

				howToPlayGuideImageFrame2.style.left = howToPlayGuideImage.style.left;
				
				return;

			}

executeTransitionEffect();

howToPlayGuideImage.style.visibility = "hidden";
howToPlayGuideImageFrame2.style.visibility = "hidden";

      //added by Mike, 20231124
      if (bIsBossBattleDone) {

  			//removed by Mike, 20231111
  			//alert("CONGRATULATIONS!");

  			//added by Mike, 20231111
  			//var sText = "CONGRATULATIONS!";
			//OK
  			//var sText = "CONGRATULATIONS!<br/>HALLO!";
//  			var sText = "MISSION COMPLETE!<br/><br/>COMPLETION TIME:";

  			//var sText = "The <font color='purple'>PEST</font> was destroyed.<br/>But not without heavy<br/> damage to the city.<br/>There is still a lot to learn<br/>and do. Thank you, and<br/> great work! Peace.";
			
			//var sText = "The <font color='#393da2'>PEST</font> was destroyed.<br/>But not without heavy<br/> damage to the city.<br/>There is still a lot to learn<br/>and do. Thank you, and<br/> great work! Peace.";

			//var sText = "The <font color='#393da2'>CREATURE</font> was<br/> destroyed, but not without<br/> inflicting heavy damage<br/> to the city...We still have<br/> a lot to learn, and also to do.<br/> Thank you, and great work! Peace.";

			//edited by Mike, 20231130
			var sText = "The <font color='#4a50d9'>PEST</font> was destroyed.<br/>But not without heavy<br/> damage to the city...<br/>There is still a lot to learn<br/>and do. Thank you, and<br/> great work! Peace.";
						
			//var sCurrText="";
	
			
			
			iCurrTextCharacterCountMax=sText.length;
			
			//include last character
//			if (iCurrTextCharacterCount<iCurrTextCharacterCountMax) {
			if (iCurrTextCharacterCount<=iCurrTextCharacterCountMax) {
				sCurrText=sText.substring(0,iCurrTextCharacterCount);
			}
			iCurrTextCharacterCount++;

  			textStatusDiv.innerHTML = sCurrText;//sText;

  			//alert(sText.length);
  			var iTextStatusDivWidth = (textStatusDiv.clientWidth);
  			var iTextStatusDivHeight = (textStatusDiv.clientHeight);
			
			//added by Mike, 20231128
			var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");


  			//TODO: -update: this
  			//iOffsetWidth
  			textStatusDiv.style.left = 0+iHorizontalOffset+iStageMaxWidth/2 -iTextStatusDivWidth/2 +"px";

  				//textStatusDiv.style.left = 0+iHorizontalOffset+iOffsetWidth+"px";

  			//iOffsetHeight
  			//textStatusDiv.style.top = 0+iStageMaxHeight-iTextStatusDivHeight*1.5+"px";
  			//textStatusDiv.style.top = 0+"px";
			textStatusDiv.style.top = 0+(iStageMaxHeight*0.10)+"px";
  			
  			textStatusDiv.style.visibility="visible";
			//added by Mike, 20231128
			mainImageTileProjectile.style.visibility="hidden";
			
			//added by Mike, 20231128
			textStatusBackgroundDiv.style.top=textStatusDiv.style.top;
			textStatusBackgroundDiv.style.left=0+iStageMaxWidth*0.15;//textStatusDiv.style.left;//0;
			textStatusBackgroundDiv.style.visibility="visible";


			textStatusBackgroundDiv.style.width=iStageMaxWidth*0.65;
			textStatusBackgroundDiv.style.height=iStageMaxHeight*0.6;			
	  }
      else {
	  		//added by Mike, 20231127
			if (bIsExecutingTransition) {
				return;
			}


        mainImageMonsterBoss.style.visibility = "visible";


//executeExplosionEffect();

//TODO: -update: this
if (iCurrMapLocation==53) {
	executeExplosionEffectToCity();
}
else {
  var explosionEffectImage = document.getElementById("explosionEffectToCityImageId");
  explosionEffectImage.style.visibility="hidden";
}

//executeExplosionEffectToMonsterBoss();

//added by Mike, 20241105
executeDustEffect();


	//alert("mainImageTileProjectileVelocityY: "+mainImageTileProjectileVelocityY);

	if (mainImageTileProjectileStepY<mainImageTileProjectileStepYMax) {
		mainImageTileProjectileStepY+=mainImageTileProjectileVelocityY;//++;
	}

	if (mainImageTileProjectileStepX<mainImageTileProjectileStepXMax) {
		mainImageTileProjectileStepX+=mainImageTileProjectileVelocityX;//++;
	}


//-----------------------

	//		mainImageTilePosX++;
//		mainImageTilePosX--;
//		mainImageTilePosY++;

		//edited by Mike, 20230423; from 20230418
		//autoIdentifyNextDirectionAI();
		//autoIdentifyNextDirectionAIPart2Mouse();


/*	//edited by Mike, 20231125
		//edited by Mike, 20230421
		mainImageTilePosX+=mainImageTileStepX; //horizontal movement;
*/
		if (arrayKeyPressed[iKEY_D]==true) {
			mainImageTilePosX+=mainImageTileStepX; //horizontal movement;
			arrayKeyPressed[iKEY_D]=false;
		}
		else if (arrayKeyPressed[iKEY_A]==true) {
			mainImageTilePosX-=mainImageTileStepX; //horizontal movement;
			arrayKeyPressed[iKEY_A]=false;
		}

/*
		mainImageTilePosY+=mainImageTileStepY; //goes downward; vertical
*/

if (iHeroInvincibileCount<iHeroInvincibileCountMax) {
	iHeroInvincibileCount++;
}
else {
	iHeroInvincibileCount=0;
	bIsHeroAttacked=false;
}


//TODO: -add: in own function
//--------------------------------------


		//added by Mike, 20241104
		//INNER STAGE; MAX
		//iHorizontalOffset=(640-iStageMaxHeight)/2;
		var iInnerHorizontalOffset=(640-iStageMaxHeight)/2;		
		var iInnerVerticalOffset=iImageFrameHeight/4;//2;
		


		//added by Mike, 20241106
		var doorImageRight = document.getElementById("doorImageRightId");
		doorImageRight.style.top = 0+(iStageMaxHeight/2-iImageFrameHeightDefault)+"px";
		doorImageRight.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight-iImageFrameWidthDefault) +"px";
		doorImageRight.style.visibility="hidden";		
		
		var iDoorImageRightPosStartY=0+iStageMaxHeight/2-iImageFrameHeightDefault*1;
		var iDoorImageRightPosEndY=0+iStageMaxHeight/2+iImageFrameHeightDefault*1+iImageFrameHeightDefault/2; //+iImageFrameHeightDefault/2 is for feet
		var iDoorImageRightPosStartX=0+(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight;		

		//## --

		var doorImageLeft = document.getElementById("doorImageLeftId");		
		doorImageLeft.style.top = 0+(iStageMaxHeight/2-iImageFrameHeightDefault)+"px";
		doorImageLeft.style.left = 0+(iInnerHorizontalOffset-iImageFrameWidthDefault) +"px";
		doorImageLeft.style.visibility="hidden";

		var iDoorImageLeftPosStartY=iDoorImageRightPosStartY;
		var iDoorImageLeftPosEndY=iDoorImageRightPosEndY; 
		var iDoorImageLeftPosStartX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
																						
		//## --

		var doorImageTop = document.getElementById("doorImageTopId");
		doorImageTop.style.top = 0+iInnerVerticalOffset-iImageFrameHeightDefault+"px";
		doorImageTop.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault) +"px";
		doorImageTop.style.visibility="hidden";		

		var iDoorImageTopPosStartX=0+iStageMaxWidth/2-iImageFrameWidthDefault*1;
		var iDoorImageTopPosEndX=0+iStageMaxWidth/2+iImageFrameWidthDefault*1;
		var iDoorImageTopPosStartY=0+iInnerVerticalOffset;

		//## --

		var doorImageBottom = document.getElementById("doorImageBottomId");
		doorImageBottom.style.top = 0+iStageMaxHeight-iImageFrameHeightDefault+"px";
		doorImageBottom.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault) +"px";
		doorImageBottom.style.visibility="hidden";

		var iDoorImageBottomPosStartX=iDoorImageTopPosStartX;
		var iDoorImageBottomPosEndX=iDoorImageTopPosEndX;
		var iDoorImageBottomPosStartY=0+iStageMaxHeight-iInnerVerticalOffset*2-iImageFrameHeightDefault;
		
		batMonsterImageTile.style.visibility="hidden";

		//reminder: innerStageWidth uses iStageMaxHeight

		//iCurrMapLocation=0;
		switch(iCurrMapLocation) {
			//OK; TOP DOOR; REST of the sides WALLS
			case 53:
				//DOOR
				//top-most					
				doorImageTop.style.visibility="visible";
				
				hasInitMapLocation=true;
	
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault*2))) { 
						
						
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=43;
						hasInitMapLocation=false;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();
				}
								
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left-most
				else if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}					
				break;		
			//OK; TOP, LEFT, BOTTOM DOORS; REST of the sides WALLS
			case 43:			
				doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
				doorImageLeft.style.visibility="visible";
				
				if (!hasInitMapLocation) {
					isBatMonsterTileActive=true;
					batMonsterImageTile.style.visibility="visible";
					
					//TilePosX; width; square based on iStageMaxHeight
					batMonsterImageTilePosX=iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault/2;
					batMonsterImageTilePosY=iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeightDefault/2;
				}
				
				hasInitMapLocation=true;

				if (isBatMonsterTileActive) {
					batMonsterImageTile.style.visibility="visible";

/*			
				batMonsterImageTile.style.top = 0+iInnerVerticalOffset+iStageMaxHeight/2-iImageFrameHeightDefault+"px";
				batMonsterImageTile.style.left = 0+(iInnerHorizontalOffset+iStageMaxHeight/2-iImageFrameWidthDefault) +"px";
*/				
					batMonsterImageTile.style.top = 0+batMonsterImageTilePosY+"px"; //iInnerVerticalOffset
					batMonsterImageTile.style.left = 0+batMonsterImageTilePosX+"px"; //iInnerHorizontalOffset
			
					executeMonsterWalkingAnimation();
					verifyHeroCollideWithMonsters();
				}
				
				//top door
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
												
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();		
						
						//DOOR
						iCurrMapLocation=33;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom door
				//else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//alert("DITO");
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) {						
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=53;
					}	
					//bottom wall
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();					
					}				
				}					
				
				//left wall with door at center				
				if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=42;
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}
				//right wall only
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();			
				}		
				break;		
			//OK; TOP, BOTTOM DOORS; REST of the sides WALLS
			case 33:
				doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
				
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=23;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=43;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//left wall with door at center
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}
				//WALL
				//right wall only
				//square rooms; hence, iStageMaxHeight
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				break;
			//OK; TOP, BOTTOM DOORS; REST of the sides WALLS
			case 23: //SECRET PASSAGE
				doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
			
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=13;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=33;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}					
				
				//left wall
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}
				//WALL
				//right wall only
				//square rooms; hence, iStageMaxHeight
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				break;		
			//OK; LEFT, BOTTOM DOORS; REST of the sides WALLS
			case 13: //SECRET PASSAGE			
				doorImageLeft.style.visibility="visible";
				doorImageBottom.style.visibility="visible";

				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
					resetProjectile();
				}							
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=23;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}							
				
				//left wall with door at center				
				if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=12;
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}				
				//right wall only
				else if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();			
				}		
				break;				
			//OK; ALL of the sides WALLS
			case 12: //SECRET ROOM; BEST ENDING
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
					resetProjectile();
				}			
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					resetProjectile();
				}
										
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left-most
				else if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}
				break;			
			//OK; LEFT, RIGHT DOORS; REST of the sides WALLS
			case 42:			
				doorImageRight.style.visibility="visible";
				doorImageLeft.style.visibility="visible";
				
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
					resetProjectile();
				}	
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					resetProjectile();
				}	
										
				//left wall with door at center
				if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=41;
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}
				//square rooms; hence, iStageMaxHeight
				//right wall with door at center
				else if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {		

					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						//OK; wraps around
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=43;
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}	
				break;				
			//OK; TOP, RIGHT DOORS; REST of the sides WALLS
			case 41:			
				doorImageTop.style.visibility="visible";
				doorImageRight.style.visibility="visible";

				//square rooms; hence, iStageMaxHeight				
				//top wall with door at center
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=31;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}				
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					
					//alert("mainImageTilePosX: "+mainImageTilePosX);				
					resetProjectile();
				}
										
				//left-most wall				
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}			
				//square rooms; hence, iStageMaxHeight
				//right wall with door at center
				else if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {					
					
					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						//OK; wraps around
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=42;
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}				
				break;
			//OK; TOP, BOTTOM, RIGHT DOORS; REST of the sides WALLS
			case 31:
				doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
				doorImageRight.style.visibility="visible";
				
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault*2))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=21;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=41;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//left wall with door at center
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}				
				//square rooms; hence, iStageMaxHeight
				//right wall with door at center
				else if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {					
					
					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						//OK; wraps around
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=32;
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}	
				break;
			//OK; LEFT DOOR, REST of the sides WALLS
			case 32: //BOSS ROOM; BOSS KEY NECESSARY
				doorImageLeft.style.visibility="visible";
			
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
					resetProjectile();
				}			
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					resetProjectile();
				}
										
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left wall with door at center
				else if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=31;
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}				
				break;		
			//OK; TOP, BOTTOM, RIGHT DOORS; REST of the sides WALLS
			case 21:
				doorImageTop.style.visibility="visible";
				doorImageBottom.style.visibility="visible";
				doorImageRight.style.visibility="visible";
				
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {					

					if (((mainImageTilePosX>=iDoorImageTopPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageTopPosEndX)) || 					
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageTopPosStartX,iDoorImageTopPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault*2))) { 
						//OK; wraps around
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						
						mainImageTilePosX=iDoorImageTopPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=11;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						resetProjectile();						
					}					
				}
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=31;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//left wall with door at center
				if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}				
				//square rooms; hence, iStageMaxHeight
				//right wall with door at center
				else if (mainImageTilePosX+iImageFrameWidthDefault>iDoorImageRightPosStartX) {					
					
					if (((mainImageTilePosY>=iDoorImageRightPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageRightPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageRightPosStartX,iDoorImageRightPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
						
						//OK; wraps around
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=22;
					}			
					else {
						//OK;
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						resetProjectile();						
					}					
				}	
				break;		
			//OK; LEFT DOOR, REST of the sides WALLS
			case 22:
				doorImageLeft.style.visibility="visible";
			
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
					resetProjectile();
				}			
				//bottom wall
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
					//OK;
					mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
					resetProjectile();
				}
										
				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left wall with door at center
				else if (mainImageTilePosX<iDoorImageLeftPosStartX) {					

					if (((mainImageTilePosY>=iDoorImageLeftPosStartY) && (mainImageTilePosY+iImageFrameWidthDefault<=iDoorImageLeftPosEndY)) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageLeftPosStartX,iDoorImageLeftPosStartY, iImageFrameWidthDefault, iImageFrameHeightDefault*2))) { 
											
						//OK; wraps around
						mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
						
						mainImageTilePosY=iDoorImageLeftPosStartY+iImageFrameHeightDefault/2;
						
						resetProjectile();			
						
						//DOOR
						iCurrMapLocation=21;
					}			
					else {
						//OK;
						mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
						resetProjectile();						
					}					
				}				
				break;		
			//OK; BOTTOM DOOR; REST of the sides WALLS
			case 11:
				doorImageBottom.style.visibility="visible";
				
				//WALL
				//square rooms; hence, iStageMaxHeight				
				//top wall
				if (mainImageTilePosY<0+iInnerVerticalOffset+iImageFrameHeightDefault/2) {		
					//OK
					mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
					resetProjectile();
				}		
				//bottom door
				else if (mainImageTilePosY+iImageFrameHeightDefault>0+iStageMaxHeight-iInnerVerticalOffset-iImageFrameHeightDefault/2) {
						
					if ((((mainImageTilePosX>=iDoorImageBottomPosStartX) && (mainImageTilePosX+iImageFrameWidthDefault<=iDoorImageBottomPosEndX))) ||	
						(isPointsOfRectIntersectingPointsOfRectDoor(mainImageTilePosX+iImageFrameWidthDefault/2,mainImageTilePosY+iImageFrameHeightDefault/2, iDoorImageBottomPosStartX,iDoorImageBottomPosStartY, iImageFrameWidthDefault*2, iImageFrameHeightDefault))) { 
						//OK; wraps around
						mainImageTilePosY=0+iInnerVerticalOffset+iImageFrameHeightDefault/2;
						
						mainImageTilePosX=iDoorImageBottomPosStartX+iImageFrameWidthDefault/2;
						
						resetProjectile();			
												
						//DOOR
						iCurrMapLocation=21;
					}			
					else {
						//OK;
						mainImageTilePosY=0+iStageMaxHeight-iInnerVerticalOffset*3-iImageFrameHeightDefault;
						resetProjectile();						
					}						
				}	

				//WALL
				//right-most
				//square rooms; hence, iStageMaxHeight
				if (mainImageTilePosX+iImageFrameWidthDefault>(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight) {
					//OK;
					mainImageTilePosX=(iInnerHorizontalOffset-iImageFrameWidthDefault)+iStageMaxHeight-iImageFrameWidthDefault;
					resetProjectile();			
				}
				//left wall with door at center
				else if (mainImageTilePosX<0+(iInnerHorizontalOffset+iImageFrameWidthDefault)) {
					//OK;
					mainImageTilePosX=0+(iInnerHorizontalOffset+iImageFrameWidthDefault);
					resetProjectile();
				}
				break;				
		}


		//STAGE; MAX
		if (mainImageTilePosX+iImageFrameWidthDefault>iStageMaxWidth) {
			mainImageTilePosX=iStageMaxWidth-iImageFrameWidthDefault;
		}
		else if (mainImageTilePosX<0) {
			mainImageTilePosX=0;
		}
		


		if (mainImageTilePosY+iImageFrameHeightDefault>iStageMaxHeight) {
			//edited by Mike, 20231126
			//mainImageTilePosY=iStageMaxHeight-iImageFrameHeightDefault;
			mainImageTilePosY=iStageMaxHeight-iImageFrameHeightDefault-iImageFrameHeightDefault*0.25;
		}
		else if (mainImageTilePosY<0) {
			mainImageTilePosY=0;
		}
				
		
//--------------------------------------		

		
		//DOOR
		//added by Mike, 20241104
/*		
		if ((mainImageTilePosX+iImageFrameWidth>=iInnerHorizontalOffset+iStageMaxWidth/2) && (mainImageTilePosX<=iInnerHorizontalOffset+iStageMaxWidth/2+iImageFrameWidth)) {
	
	//alert("DITO!!!");
	
		//if (isPointsOfRectIntersectingPointsOfRect(mainImageTilePosX,mainImageTilePosY, iInnerHorizontalOffset+iStageMaxWidth/2,iInnerHorizontalOffset+iStageMaxWidth/2)) {
*/				
				
/*			
		}
*/		

/*	//removed by Mike, 20241104
    if (mainImageMonsterBossPosY+iMonsterBossTileHeight>iStageMaxHeight) {
			mainImageMonsterBossPosY=iStageMaxHeight-iMonsterBossTileHeight;

			
			//edited by Mike, 20231127
////			iScore=1;
////			iTargetScore=1;
			
			iTargetScore=1;
			bIsIncreasingScore=false;
		    //setMonsterExplosionEffectPosition(0+iHorizontalOffset+iStageMaxHeight-iMonsterBossTileWidth/2,mainImageMonsterBossPosY+iMonsterBossTileHeight/2);
			
			
		    //note: error in output due to reuse of same animation count via function setMonsterExplosion...	//setMonsterExplosionEffectPosition(0+parseInt(textScoreShadowDiv.style.left),+parseInt(textScoreShadowDiv.style.top));
			
			//removed by Mike, 20231128
			//bIsExecutingShake=true;	
			//increase rotation speed;
			//iTransitionRotate=(iTransitionRotate+10)%360;		

			if (iScore==1) {
				if (iMonsterBossAttackDelayCount<iMonsterBossAttackDelayCountMax) {
					iMonsterBossAttackDelayCount++;
				}
				else {			
					iTransitionRotate=(iTransitionRotate+30)%360;
					mainImageMonsterBoss.style.transform = "rotate("+iTransitionRotate+"deg)";	
					mainImageMonsterBoss.style.transformOrigin = "12.5% 12.5%"; 
				}

			
			}			
		}
		else {		
			//added by Mike, 20231126
			mainImageMonsterBossPosY+=3;//2;//++;
			iTransitionRotate=(iTransitionRotate+10)%360;
			
			//mainImageMonsterBoss.style.transform = "rotate("+iTransitionRotate+"deg)"+" scale("+iTransitionScale+","+iTransitionScale+")";	
			mainImageMonsterBoss.style.transform = "rotate("+iTransitionRotate+"deg)";	
			mainImageMonsterBoss.style.transformOrigin = "12.5% 12.5%"; //"50% 50%"; //	
			
			//bIsExecutingShake=true;	
		}
*/		
		
		//added by Mike, 20231129
		var bossBattleBgImage = document.getElementById("bossBattleBgImageId");
		//setCityExplosionEffectPosition(parseInt(bossBattleBgImage.style.left)+bossBattleBgImage.clientWidth*0.3,parseInt(bossBattleBgImage.style.top)+bossBattleBgImage.clientHeight/2);

/*	//removed by Mike, 20241109
		setCityExplosionEffectPosition(parseInt(bossBattleBgImage.style.left)+bossBattleBgImage.clientWidth*0.1,parseInt(bossBattleBgImage.style.top)+bossBattleBgImage.clientHeight/3);
*/				
				//setCityExplosionEffectPosition(0,parseInt(bossBattleBgImage.style.top)+bossBattleBgImage.clientHeight/5);

				
				//setCityExplosionEffectPosition(0,0);		

    //ANIMATION;
//    mainImageMonsterBoss.style.objectPosition = "-" + 128 + "px -" + 0 + "px";

    //alert(iAnimationDelayCount);

    if (iBossMonsterAnimationDelayCount==iBossMonsterAnimationDelayCountMax) {
      iBossMonsterAnimationCount=(iBossMonsterAnimationCount+1)%2; //iAnimationCountMax
      iBossMonsterAnimationDelayCount=0;
    }
    else {
      iBossMonsterAnimationDelayCount++;
      //bIsMonsterBossHit=false;
    }
	

	//edited by Mike, 20241103
	//alert("iAnimationCount: "+iAnimationCount);
	if (iAnimationDelayCount==iAnimationDelayCountMax) {
		//edited by Mike, 20231116
//		iAnimationCount=(iAnimationCount+1)%2; //iAnimationCountMax
		iAnimationCount=(iAnimationCount+1)%3; //2; //iAnimationCountMax
		iAnimationDelayCount=0;
	}
	else {
		iAnimationDelayCount++;
	}


    if (bIsMonsterBossHit) {
      //alert(iAnimationCount);
      mainImageMonsterBoss.style.objectPosition = "-" + 128*(iBossMonsterAnimationCount) + "px -" + 128 + "px";

      if (iAnimationCount==1) {
        bIsMonsterBossHit=false;
        
		//edited by Mike, 20231128
		//iBossLife--;
		if (iScore==1) {
			iBossLife--;
		}
		

		//edited by Mike, 20231128
//		if (mainImageMonsterBoss.style.visibility!="hidden") {
		if (!bIsBossBattleDone) {
			setMonsterExplosionEffectPosition(parseInt(mainImageMonsterBoss.style.left)+iMonsterBossTileWidth/4,parseInt(mainImageMonsterBoss.style.top)+iMonsterBossTileHeight/4);
		}

        if (iBossLife<=0) {
            //alert("MISSION COMPLETE!");
			mainImageMonsterBoss.style.visibility="hidden";
			bIsBossBattleDone=true;
        }
      }
    }
    else {
      mainImageMonsterBoss.style.objectPosition = "-" + 128*(iBossMonsterAnimationCount) + "px -" + 0 + "px";
    }

		mainImageTile.style.left = (iHorizontalOffset+mainImageTilePosX)+"px";
		mainImageTile.style.top = (iVerticalOffsetInnerScreen+mainImageTilePosY)+"px";

		//added by Mike, 20231125
		mainImageTileTankBody.style.left = mainImageTile.style.left;
		mainImageTileTankBody.style.top = mainImageTile.style.top;

		mainImageTileHeroBody.style.left = mainImageTile.style.left;
		mainImageTileHeroBody.style.top = mainImageTile.style.top;

    mainImageMonster.style.left = (iHorizontalOffset+mainImageMonsterPosX)+"px";
    mainImageMonster.style.top = (iVerticalOffsetInnerScreen+mainImageMonsterPosY)+"px";

    mainImageMonsterBoss.style.left = (iHorizontalOffset+mainImageMonsterBossPosX)+"px";
    mainImageMonsterBoss.style.top = (iVerticalOffsetInnerScreen+mainImageMonsterBossPosY)+"px";


//-----------------------

			//added by Mike, 20230427
			//movement
			if (bHasFired) {

			  	//mainImageTileProjectile.style.visibility = "visible";
			  	mainImageTileProjectile.style.visibility = "hidden";


mainImageTileProjectilePosY=parseInt(mainImageTileProjectilePosY)+newMainImageTileProjectilePosY;

					mainImageTileProjectilePosX=parseInt(mainImageTileProjectilePosX)+newMainImageTileProjectilePosX;
		

		mainImageTileProjectile.style.left = mainImageTileProjectilePosX+"px";

		mainImageTileProjectile.style.top = mainImageTileProjectilePosY+"px";

		if ((mainImageTilePosX==mainImageTileProjectilePosX) && (mainImageTilePosY==mainImageTileProjectilePosY)) {
			resetProjectile();
			return;
		}
		
		mainImageTilePosX=mainImageTileProjectilePosX;		
		mainImageTilePosY=mainImageTileProjectilePosY;
		
		
		if (bIsHeroInTank) {
			executeTankWalkingAnimation();
		}
		else {
			executeHeroWalkingAnimation();
		}

//-----------------

    if (isPointsOfRectIntersectingPointsOfRect(mainImageTileProjectilePosX,mainImageTileProjectilePosY, parseInt(mainImageMonster.style.left),parseInt(mainImageMonster.style.top))) {
//        alert("HIT!");
      mainImageMonster.style.visibility="hidden";
    }

	//edited by Mike, 20231128
	if (!bIsBossBattleDone) {
		if (isPointsOfRectIntersectingPointsOfRect(mainImageTileProjectilePosX,mainImageTileProjectilePosY, parseInt(mainImageMonsterBoss.style.left),parseInt(mainImageMonsterBoss.style.top))) {
	//        alert("HIT!");
		  //mainImageMonsterBoss.style.visibility="hidden";
		  //added by Mike, 20231126
		  bIsMonsterBossHit=true;

		  //added by Mike, 20231126
		  resetProjectile();
		}
	}

//-----------------

		if (bIsHeroInTank) {
			iImageFrameWidth=iImageFrameWidthLarge;
		}
		else {
			iImageFrameWidth=iImageFrameWidthDefault;
		}

//destination to the left of hero projectile
		//if (!bHasReachedDestinationX) {
			if (newMainImageTileProjectilePosX<0) {
				if (mainImageTileProjectilePosX+iImageFrameWidth/2<=mainImageTileProjectileStepDestinationX) {
						
				  mainImageTileProjectilePosX=mainImageTileProjectileStepDestinationX-iImageFrameWidth/2;
				  bHasReachedDestinationX=true;
				  //resetProjectile();
				}
				else {
				  bHasReachedDestinationX=false;
				}
			}
			//destination to the right of hero projectile
			else {
				if (mainImageTileProjectilePosX+iImageFrameWidth/2>=mainImageTileProjectileStepDestinationX) {
					mainImageTileProjectilePosX=mainImageTileProjectileStepDestinationX-iImageFrameWidth/2;
					bHasReachedDestinationX=true;
					//resetProjectile();
				}		
				else {
				  bHasReachedDestinationX=false;
				}				
			}
		//}
		
		//if (!bHasReachedDestinationY) {		
			//destination to the top of hero projectile
			if (newMainImageTileProjectilePosY<0) {
				if (mainImageTileProjectilePosY+iImageFrameHeight/2<=mainImageTileProjectileStepDestinationY) {
										
				mainImageTileProjectilePosY=mainImageTileProjectileStepDestinationY-iImageFrameHeight/2;
				bHasReachedDestinationY=true;
				//resetProjectile();
				}
				else {
				  bHasReachedDestinationY=false;
				}				
			}
			//destination to the bottom of hero projectile
			else {
				if (mainImageTileProjectilePosY+iImageFrameHeight/2>=mainImageTileProjectileStepDestinationY) {
					mainImageTileProjectilePosY=mainImageTileProjectileStepDestinationY-iImageFrameHeight/2;
					bHasReachedDestinationY=true;
					//resetProjectile();
				}			
				else {
				  bHasReachedDestinationY=false;
				}								
			}			
		//}
		
							
			if ((bHasReachedDestinationX) && (bHasReachedDestinationY)) {
				resetProjectile();				
			}				

			if (mainImageTileProjectilePosX+iImageFrameWidth>iStageMaxWidth+iHorizontalOffset) {
	//+iImageFrameWidth
				resetProjectile();
			}
			else if (mainImageTileProjectilePosX<0+iHorizontalOffset){
					resetProjectile();
			}

			if (mainImageTileProjectilePosY+iImageFrameHeight/2>iStageMaxHeight) {
				resetProjectile();
			}
			else if (mainImageTileProjectilePosY<0) {
				resetProjectile();
			}		
		
			}

		  }	 
		}
	}



  function processResultFromInput(iXPos, iYPos) {

      if (!bIsBossBattleDone) {
        processBossBattleResultFromInput(iXPos, iYPos);
      }

  }


  function processBossBattleResultFromInput(iXPos, iYPos) {

	//added by Mike, 20231130
  	if (bIsExecutingTransition) {
		return;
	}
		
		
/*
if (iMouseClickStartTime!=0) {
alert(Date.now()-iMouseClickStartTime);
}
*/

	//added by Mike, 20231124
	var mainImageTile = document.getElementById("mainImageTileImageId");
	//removed by Mike, 20231128
	//mainImageTile.style.visibility = "visible";

	//added by Mike, 20231124
	var mainImageTileTankBody = document.getElementById("mainImageTileImageTankBodyId");

	var mainImageTileHeroBody = document.getElementById("mainImageTileImageHeroBodyId");

	//removed by Mike, 20231128
	//mainImageTileTankBody.style.visibility = "visible";
	
	//added by Mike, 20231130
	var mainImageTileProjectile = document.getElementById("mainImageTileProjectileImageId");
	
	//edited by Mike, 20241105; 20241103
	bHasFiredTemp = bHasFired;
	
	//note: resets also bHasFired;
	resetProjectile();
/*	
	if ((!bHasReachedDestinationX) || (!bHasReachedDestinationY)) {
		resetProjectile();				
	}	
*/
	
	if (bIsHeroInTank) {
		if (isPointsOfRectIntersectingPointsOfRect(iXPos,iYPos, parseInt(mainImageTileTankBody.style.left),parseInt(mainImageTileTankBody.style.top))) {
			if ((iXPos==iPrevMouseXPos) && (iYPos==iPrevMouseYPos)) {	
				//TODO: -add: hit wall animation;
				return;
			}
		}
		
		if (isPointsOfRectIntersectingPointsOfRect(iXPos,iYPos, iPrevMouseXPos,iPrevMouseYPos)) {
			
			//do this only if at the borders of the inner stage		
			//INNER STAGE; MAX
			//iHorizontalOffset=(640-iStageMaxHeight)/2;
			var iInnerHorizontalOffset=(640-iStageMaxHeight)/2;
			var iInnerVerticalOffset=iImageFrameHeightLarge/2;

			//reminder: innerStageWidth uses iStageMaxHeight
		
			if (mainImageTilePosX+iImageFrameWidthLarge>=iInnerHorizontalOffset+iStageMaxHeight) {
				return;
			}
			else if (mainImageTilePosX<=0+iInnerHorizontalOffset) {
				return;
			}		
			
			if (mainImageTilePosY+iImageFrameHeightLarge>=0+iStageMaxHeight-iInnerVerticalOffset) {
				return;
			}
			else if (mainImageTilePosY<=0) {
				return;
			}	
		}		
	}
	else {	
		if (isPointsOfRectIntersectingPointsOfRect(iXPos,iYPos, parseInt(mainImageTileHeroBody.style.left),parseInt(mainImageTileHeroBody.style.top))) {
			//alert("HIT!");
			//no change
			//if ((bHasReachedDestinationX) && (bHasReachedDestinationY)) {
				if ((iXPos==iPrevMouseXPos) && (iYPos==iPrevMouseYPos)) {	
					//TODO: -add: hit wall animation;
					return;
				}
			//}	
		}	
	
		//added by Mike, 20241104
		if (isPointsOfRectIntersectingPointsOfRect(iXPos,iYPos, iPrevMouseXPos,iPrevMouseYPos)) {
			//TODO: -add: hit wall animation;
			//return;
			
			//do this only if at the borders of the inner stage
		
			//INNER STAGE; MAX
			//iHorizontalOffset=(640-iStageMaxHeight)/2;
			var iInnerHorizontalOffset=(640-iStageMaxHeight)/2;
			var iInnerVerticalOffset=iImageFrameHeight/2;

			//reminder: innerStageWidth uses iStageMaxHeight
		
			if (mainImageTilePosX+iImageFrameWidth>=iInnerHorizontalOffset+iStageMaxHeight) {
				return;
			}
			else if (mainImageTilePosX<=0+iInnerHorizontalOffset) {
				return;
			}		
			
			if (mainImageTilePosY+iImageFrameHeight>=0+iStageMaxHeight-iInnerVerticalOffset) {
				return;
			}
			else if (mainImageTilePosY<=0) {
				return;
			}	
		}
	}	
		
	iPrevMouseXPos=iXPos;
	iPrevMouseYPos=iYPos;

	//--------------------------------
	bIsHeroDash=false;

	if ((Date.now()-iMouseClickStartTime)<=iMouseClickMaxElapsedTime) {
		//alert(Date.now()-iMouseClickStartTime);
		bIsHeroDash=true;
	}
	
	iMouseClickStartTime=Date.now(); //in milliseconds
	//--------------------------------

	//resetProjectile() sets bHasFired to false;
	//if (!bHasFired) {
	//becomes DASH attack;
	//TODO: -add: elapsed time to be pressed rapidly to execute;
	if (bHasFiredTemp) {
		//quick double mouse click; within 1/4 second
		if (bIsHeroDash) {
			mainImageTileProjectileStepY=mainImageTileProjectileStepYMax;
			mainImageTileProjectileStepX=mainImageTileProjectileStepXMax;
		}
	}
	else {

/*	//edited by Mike, 20231125
    mainImageTileStepY=10;
    mainImageTileStepX=10;
*/
		mainImageTileProjectileStepY=mainImageTileProjectileVelocityY;
		mainImageTileProjectileStepX=mainImageTileProjectileVelocityX;
	}

    //reference: https://stackoverflow.com/questions/15994194/how-to-convert-x-y-coordinates-to-an-angle; last accessed: 20230428;
    //--> answer by: Mohsen, 20130413T2357; from 20150322T2246;

    //start position @center
    //note: subtract margine offset
    /*
    var iDeltaX=iXPos-mainImageTilePosX;
    var iDeltaY=iYPos-mainImageTilePosY;
    */
    /*
    var iDeltaX=(iXPos-iHorizontalOffset)-mainImageTilePosX;
    var iDeltaY=(iYPos-iVerticalOffset)-mainImageTilePosY;
    */

	var iDeltaX=(iXPos-iHorizontalOffset)-(mainImageTilePosX+iImageFrameWidth/2);
	var iDeltaY=(iYPos-iVerticalOffset)-(mainImageTilePosY+iImageFrameHeight/2);
	
	if (bIsHeroInTank) {
		iDeltaX=(iXPos-iHorizontalOffset)-(mainImageTilePosX+iImageFrameWidthLarge/2);
		iDeltaY=(iYPos-iVerticalOffset)-(mainImageTilePosY+iImageFrameHeightLarge/2);
	}

    //alert("iXPos: "+iXPos);

    /*
    alert("mainImageTilePosX: "+mainImageTilePosX);
    alert("iDeltaX: "+iDeltaX);
    */


    iDeltaY*=-1;

    var fMainImageTileStepAngleRad=Math.atan2(iDeltaX,iDeltaY);

    iMainImageTileStepAngle=fMainImageTileStepAngleRad*(180/Math.PI);

    //					newMainImageTileProjectilePosY*=-1;

    //clockwise
    iMainImageTileStepAngle=(iMainImageTileStepAngle)%360;
    /*
    alert(iMainImageTileStepAngle);
    */

    					mainImageTile.style.transform = "rotate("+ (iMainImageTileStepAngle % 360) +"deg)";



    newMainImageTileProjectilePosY=mainImageTileProjectileStepY*Math.cos(fMainImageTileStepAngleRad).toFixed(3);

    					newMainImageTileProjectilePosY*=-1;
    					newMainImageTileProjectilePosX=mainImageTileProjectileStepX*Math.sin(fMainImageTileStepAngleRad).toFixed(3);

		//added by Mike, 20231125
		mainImageTileProjectilePosX = mainImageTile.style.left;
		mainImageTileProjectilePosY = mainImageTile.style.top;


	//added by Mike, 20241103
	mainImageTileProjectileStepDestinationX=iXPos;//iDeltaX;//newMainImageTileProjectilePosX;//.iDeltaX;
	mainImageTileProjectileStepDestinationY=iYPos;//iDeltaY;//newMainImageTileProjectilePosY;//iDeltaY;
	
	

    					bHasFired=true;
						
						//added by Mike, 20241104
						//start at second frame; due to at present, no idle animation yet;
						//need to also display movement in animation;
						iHeroAnimationCount=1;
				
				var myAudioEffectCannonFire = document.getElementById("myAudioEffectCannonFireId");

				myAudioEffectCannonFire.setAttribute("src", sAudioEffectActionCannonFire);

				//fMyAudioEffectVolume=0.2;
				fMyAudioEffectCannonFireVolume=1.0;
				myAudioEffectCannonFire.volume=fMyAudioEffectCannonFireVolume;
				myAudioEffectCannonFire.loop=false;
				myAudioEffectCannonFire.play();

/*
		if (newMainImageTileProjectilePosX+iImageFrameWidth/2<0) {
			bIsHeroFacingLeft=true;
		}
		else if (newMainImageTileProjectilePosX>0) {
			bIsHeroFacingLeft=false;
		}
		else {// if (newMainImageTileProjectilePosX==0) {
			//bIsHeroFacingLeft=true;
			//keep current facing direction
		}
*/		
		if (iDeltaX<0) {
			bIsHeroFacingLeft=true;
		}
		else if (iDeltaX>0) {
			bIsHeroFacingLeft=false;
		}
		else {
			//bIsHeroFacingLeft=false;
		}					
				
		//added by Mike, 20241105
		setDustEffectPosition(mainImageTilePosX,mainImageTilePosY);
/*		
    }
*/
    //added by Mike, 20231119
    //reached this part
    //bIsPuzzleTileTargetHit=false;
  
  }

	//added by Mike, 20231125
	function initKeyboardInput() {
		document.body.onkeydown = function(e){
			//alert("e.keyCode: "+e.keyCode);

				//added by Mike, 20221121
				bIsActionKeyPressed=false;


				//RIGHT ARROW; 39
				//LEFT ARROW; 37
				//UP ARROW; 38
				//DOWN ARROW; 40
				//alert(e.keyCode);


				//OK; //note: unicode keycode, where: key d : 100?
				//note: auto-accepts keyhold; however, with noticeable delay
				//solved: via bKeyDownRight = false; et cetera
				if (e.keyCode==68) { //key d
			//			alert("dito");
					arrayKeyPressed[iKEY_D]=true;
				}
				else if (e.keyCode==65) { //key a
					arrayKeyPressed[iKEY_A]=true;
				}

				if (e.keyCode==39) { //key RIGHT
					arrayKeyPressed[iKEY_D]=true;
				}
				else if (e.keyCode==37) { //key LEFT
					arrayKeyPressed[iKEY_A]=true;
				}


/*
				if (e.keyCode==87) { //key w
					arrayKeyPressed[iKEY_W]=true;
				}
				else if (e.keyCode==83) { //key s
					arrayKeyPressed[iKEY_S]=true;
				}
*/

/*
				//added by Mike, 20221101
				//notes: RIGHT-SIDE BUTTONS to already accept
				//both capital and small letters

				//RIGHT-SIDE BUTTONS
				if (e.keyCode==73) { //key i
					arrayKeyPressed[iKEY_I]=true;

					//added by Mike, 20221121
					bIsActionKeyPressed=true;
				}
				else if (e.keyCode==75) { //key k
					arrayKeyPressed[iKEY_K]=true;

					//added by Mike, 20221121
					bIsActionKeyPressed=true;
				}

				if (e.keyCode==74) { //key j
					arrayKeyPressed[iKEY_J]=true;

					//added by Mike, 20221121
					bIsActionKeyPressed=true;
				}
				else if (e.keyCode==76) { //key l
					arrayKeyPressed[iKEY_L]=true;

					//added by Mike, 20221121
					bIsActionKeyPressed=true;
				}
*/
			}

			//added by Mike, 20220822
			document.body.onkeyup = function(e){
				//alert("KEYUP; e.keyCode: "+e.keyCode);
				if (e.keyCode==68) { //key d
					//edited by Mike, 20220823
					//bKeyDownRight=false;
					arrayKeyPressed[iKEY_D]=false;
				}
				else if (e.keyCode==65) { //key a
					arrayKeyPressed[iKEY_A]=false;
				}

				//added by Mike, 20220823
				if (e.keyCode==87) { //key w
					arrayKeyPressed[iKEY_W]=false;
				}
				else if (e.keyCode==83) { //key s
					arrayKeyPressed[iKEY_S]=false;
				}
/*
				//added by Mike, 20221101
				//RIGHT-SIDE BUTTONS
				if (e.keyCode==73) { //key i
					arrayKeyPressed[iKEY_I]=false;

					//added by Mike, 20221121
					bIsActionKeyPressed=false;
				}
				else if (e.keyCode==75) { //key k
					arrayKeyPressed[iKEY_K]=false;

					//added by Mike, 20221121
					bIsActionKeyPressed=false;
				}

				if (e.keyCode==74) { //key j
					arrayKeyPressed[iKEY_J]=false;

					//added by Mike, 20221121
					bIsActionKeyPressed=false;
				}
				else if (e.keyCode==76) { //key l
					arrayKeyPressed[iKEY_L]=false;

					//added by Mike, 20221121
					bIsActionKeyPressed=false;
				}
*/
			}
	}

	//added by Mike, 20230423
	function initMouseInput() {
		//reference: https://stackoverflow.com/questions/70827887/detect-click-vs-touch-in-javascript;
		//last accessed: 20221110
		//answer by:  Jacob, 20220124T0110
		document.body.addEventListener('pointerdown', (event) => {

			//added by Mike, 20231114
			if (iInputDelayCount<iInputDelayCountMax) {
				iInputDelayCount++;
				return;
			}

			//reference: https://developer.mozilla.org/en-US/docs/Web/API/PointerEvent/pointerType;
			//last accessed: 20221122
			switch(event.pointerType) {
				case 'mouse':
        //note: ZOOM function causes position ERROR via screenX
        var iXPos = event.clientX;//screenX;

        //note: screenY includes BROWSER address bar, et cetera;
        var iYPos = event.pageY; //screenY;

/*
        //edited by Mike, 20230423
        alert("iXPos: "+iXPos);
        alert("iYPos: "+iYPos);
*/

				  //added by Mike, 20231122
				  if (bHasPressedStart) {
					//alert(">");
  					if (!bHasViewedHowToPlayGuide) {
/*					
  						//alert(">>>>>");
  						var howToPlayGuideImage = document.getElementById("howToPlayGuideImageId");

							//removed by Mike, 20231127
//							howToPlayGuideImage.style.visibility = "hidden";

							
							//added by Mike, 20231127
							if (!bHasViewedHowToPlayGuide) {
							  if (!bIsExecutingTransition) {
								resetTransitionEffect();
							  }
							}
*/							
							
							bHasViewedHowToPlayGuide=true;

  						return;
  					}
				  }
				  else {
					  //added by Mike, 20231119
					  bHasPressedStart=true;

					  return;
				  }


					//added by Mike, 20231107
					processResultFromInput(iXPos, iYPos);



						//if (!bIsExecutingTransition) {
							//resetTransitionEffect();
							
							//added by Mike, 20231127
							var mainImageMonster = document.getElementById("mainImageMonster0");
							mainImageMonster.style.visibility = "hidden";
						//}



					break;
				case 'touch':
/*
					//alert("TOUCH");
					if (bIsUsingAppleWebKit) {
					  //added by Mike, 20221111; removed by Mike, 20221118
					  //note: NOT yet set
					  if (bIsUsingAppleMac) {
						toggleFullScreen();
					  }

					  bIsUsingAppleMac=false;
					  bIsMobile=true; //added by Mike, 20221110

					  //added by Mike, 20230111
					  bHasSetMaxWidthHeight=true;
					}
*/
					break;
			}
		});
	}


	//TODO: -fix: touch-and-hold image displayed problem
function initTouchInput() {
	//added by Mike, 20231107
	//reference: https://stackoverflow.com/questions/62823062/adding-a-simple-left-right-swipe-gesture/62825217#62825217;
	//answer by: smmehrab, 20200709T2330; edited 20200711T0355
	document.body.addEventListener('touchstart', function (event) {

		//added by Mike, 20231114
		if (iInputDelayCount<iInputDelayCountMax) {
			iInputDelayCount++;
			return;
		}


		iEventChangedTouchCount = event.changedTouches.length;

		for (iCount=0; iCount<iEventChangedTouchCount; iCount++) {

				//edited by Mike, 20221121
				//note: ZOOM function causes position ERROR via screenX
				var iXPos = event.changedTouches[iCount].clientX;//screenX;

				//note: screenY includes BROWSER address bar, et cetera;
				var iYPos = event.changedTouches[iCount].pageY; //screenY;

				//alert(iYPos);
/*
				alert("iXPos: "+iXPos);
				alert("iYPos: "+iYPos);
*/
				processResultFromInput(iXPos, iYPos);


		}
	});
}


  //added by Mike, 20221123
  //@return bool
  function isPointsOfRectIntersectingPointsOfRect(iXPos1, iYPos1, iXPos2, iYPos2) {
  		//alert("iPuzzleTileWidth: "+iPuzzleTileWidth);

  	let mdo1XPos = iXPos1;
  	let mdo1YPos = iYPos1;

  	//edited by Mike, 20230524
  	//set as a point; not a tile
  	let mdo1Width = 1;//iPuzzleTileWidth;
  	let mdo1Height = 1;//iPuzzleTileHeight;

  	let mdo2XPos = iXPos2;
  	let mdo2YPos = iYPos2;

	//TODO: -verify: this with LARGE

  	let mdo2Width = iImageFrameWidth; //iPuzzleTileWidth;
  	let mdo2Height = iImageFrameHeight; //iPuzzleTileHeight;

  	let iOffsetXPosAsPixel = 0;
  	let iOffsetYPosAsPixel = 0;

  	//alert("mdo1XPos: "+mdo1XPos);

  /*
  	alert("mdo1XPos: "+mdo1XPos+"; "+"mdo1Width: "+mdo1Width);
  	alert("mdo2XPos: "+mdo2XPos+"; "+"mdo2Width: "+mdo2Width);
  */

  	if ((mdo2YPos+mdo2Height < mdo1YPos+iOffsetYPosAsPixel) || //is the bottom of mdo2 above the top of mdo1?
  		(mdo2YPos > mdo1YPos+mdo1Height-iOffsetYPosAsPixel) || //is the top of mdo2 below the bottom of mdo1?
  		(mdo2XPos+mdo2Width < mdo1XPos+iOffsetXPosAsPixel) || //is the right of mdo2 to the left of mdo1?
  		(mdo2XPos > mdo1XPos+mdo1Width-iOffsetXPosAsPixel)) //is the left of mdo2 to the right of mdo1?
  	{
  		//no collision
  		return false;
  	}

  	return true;
  }

  //added by Mike, 20241109
  //@return bool
  //TODO: -add: iImageFrameWidth; iImageFrameWidthLarge
  function isPointsOfRectIntersectingPointsOfRectDoor(iXPos1, iYPos1, iXPos2, iYPos2, iDoorImageFrameWidth, iDoorImageFrameHeight) {
  	let mdo1XPos = iXPos1;
  	let mdo1YPos = iYPos1;

	//TODO: -update: this

  	//edited by Mike, 20230524
  	//set as a point; not a tile
  	let mdo1Width = 1;//iPuzzleTileWidth;
  	let mdo1Height = 1;//iPuzzleTileHeight;

  	let mdo2XPos = iXPos2;
  	let mdo2YPos = iYPos2;

  	let mdo2Width = iDoorImageFrameWidth; //iImageFrameWidth; //iPuzzleTileWidth;
  	let mdo2Height = iDoorImageFrameHeight; //iImageFrameHeight; //iPuzzleTileHeight;

  	let iOffsetXPosAsPixel = 0;
  	let iOffsetYPosAsPixel = 0;

  	//alert("mdo1XPos: "+mdo1XPos);

  /*
  	alert("mdo1XPos: "+mdo1XPos+"; "+"mdo1Width: "+mdo1Width);
  	alert("mdo2XPos: "+mdo2XPos+"; "+"mdo2Width: "+mdo2Width);
  */

  	if ((mdo2YPos+mdo2Height < mdo1YPos+iOffsetYPosAsPixel) || //is the bottom of mdo2 above the top of mdo1?
  		(mdo2YPos > mdo1YPos+mdo1Height-iOffsetYPosAsPixel) || //is the top of mdo2 below the bottom of mdo1?
  		(mdo2XPos+mdo2Width < mdo1XPos+iOffsetXPosAsPixel) || //is the right of mdo2 to the left of mdo1?
  		(mdo2XPos > mdo1XPos+mdo1Width-iOffsetXPosAsPixel)) //is the left of mdo2 to the right of mdo1?
  	{
  		//no collision
  		return false;
  	}

  	return true;
  }

  //added by Mike, 20221123
  //@return bool
  function isPointsOfRectIntersectingPointsOfRectMonster(iXPos1, iYPos1, iXPos2, iYPos2, iImageFrameWidth1, iImageFrameHeight1, iImageFrameWidth2, iImageFrameHeight2) {
  	let mdo1XPos = iXPos1;
  	let mdo1YPos = iYPos1;

  	//edited by Mike, 20230524
  	//set as a point; not a tile
  	let mdo1Width = iImageFrameWidth1; //1;//iPuzzleTileWidth;
  	let mdo1Height = iImageFrameHeight1; //1;//iPuzzleTileHeight;

  	let mdo2XPos = iXPos2;
  	let mdo2YPos = iYPos2;

  	let mdo2Width = iImageFrameWidth2; //iPuzzleTileWidth;
  	let mdo2Height = iImageFrameHeight2; //iPuzzleTileHeight;

  	let iOffsetXPosAsPixel = 0;
  	let iOffsetYPosAsPixel = 0;

  	//alert("mdo1XPos: "+mdo1XPos);

  /*
  	alert("mdo1XPos: "+mdo1XPos+"; "+"mdo1Width: "+mdo1Width);
  	alert("mdo2XPos: "+mdo2XPos+"; "+"mdo2Width: "+mdo2Width);
  */

  	if ((mdo2YPos+mdo2Height < mdo1YPos+iOffsetYPosAsPixel) || //is the bottom of mdo2 above the top of mdo1?
  		(mdo2YPos > mdo1YPos+mdo1Height-iOffsetYPosAsPixel) || //is the top of mdo2 below the bottom of mdo1?
  		(mdo2XPos+mdo2Width < mdo1XPos+iOffsetXPosAsPixel) || //is the right of mdo2 to the left of mdo1?
  		(mdo2XPos > mdo1XPos+mdo1Width-iOffsetXPosAsPixel)) //is the left of mdo2 to the right of mdo1?
  	{
  		//no collision
  		return false;
  	}

  	return true;
  }


	function onLoad() {
//alert(navigator.userAgent);


  if (/Macintosh|Mac|Mobile|Android|webOS|iPhone|iPad|iPod|AppleWebKit|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Opera Mini/i.test(navigator.userAgent)) {

//		alert("detected: Mobile Browser!");

  //added by Mike, 20220925
  bIsMobile=true;

  //added by Mike, 20221108
  if (navigator.userAgent.includes("AppleWebKit")) {
    bIsUsingAppleWebKit=true;
    //added by Mike, 20221109
    bIsUsingAppleMac=false; //default
  }

  //added by Mike, 20221113
  //notes: "AppleWebKit" to exist even with "Android"
  if (navigator.userAgent.includes("Android")) {
    bIsUsingAppleWebKit=false;
  }

  //added by Mike, 20221113
  //example: Linux x86_64 (desktop)
  if (navigator.userAgent.includes("Linux x")) {
    bIsMobile=false;
  }

  //note: iPAD and MacBookPro OS : Mac OS X
  //adds: to be re-classified as iPAD via TOUCH command
  if ((navigator.userAgent.includes("Macintosh")) || navigator.userAgent.includes("Mac")) {
    bIsUsingAppleMac=true;
  }

  //added by Mike, 20230111
  //note: TO-DO: -add: touch/mouse click ACTION COMMANDS
  //if using EDGE browser;
  //observed: shaking on EDGE browser via desktop,
  //caused by bIsMobile=true;
  if (navigator.userAgent.includes("Edge")) { //not "Edg"
    bIsMobile=false;
  }
}

/*
//note:
alert("window.innerWidth: "+window.innerWidth); //1408
alert("window.innerHeight: "+window.innerHeight); //601

alert("screen.width: "+screen.width); //1408
alert("screen.height: "+screen.height); //792

	iStageMaxWidth=640*2;
	iStageMaxHeight=360*2;
*/


		init();

		iFacingDirection=iFACING_DOWN;

		//added by Mike, 20230423
		initMouseInput();

		//added by Mike, 20231125
		initKeyboardInput();

		//added by Mike, 202301107
		initTouchInput();

		fFramesPerSecond=16.66; //100.00; //16.66;
		clearInterval(iCurrentIntervalId);
		iCurrentIntervalId=setInterval(myUpdateFunction, fFramesPerSecond);
	}




  </script>

  <body id="myBodyId" onload="onLoad();">

	<canvas id="myCanvasId" class="myCanvas">
	</canvas>

				
  <canvas id="myCanvasTwoId" class="myCanvas">
	</canvas>
			

<!-- noted by Mike, 20230424;

reference: https://stackoverflow.com/questions/5713295/specify-a-root-path-of-your-html-directory-for-script-links/41011179#41011179; last accessed: 20230424;
answer by: MistyDawn, 20161207T0655;
edited by: Huy Nguyen, 20170124T0455

/ means the root of the current drive;
./ means the current directory;
/ means the parent of the current directory.

//noted by Mike, 20231105
incorrect output on Safari; macOS;

opting to put assets folder in "html_application" folder instead
-->
	<img id="doorImageRightId" class="Image32x32Tile" src="assets/images/tile.png">
	<img id="doorImageLeftId" class="Image32x32Tile" src="assets/images/tile.png">
	<img id="doorImageTopId" class="Image32x32Tile" src="assets/images/tile.png">
	<img id="doorImageBottomId" class="Image32x32Tile" src="assets/images/tile.png">
	
	
		<img id="mainImageTileImageTankBodyId" class="ImageTankFrame1" src="assets/images/inputImageLarge.png?lastmod=20241110">
		
		<img id="mainImageTileImageHeroBodyId" class="ImageHeroFrame1" src="assets/images/inputImage.png?lastmod=20241110">		

		<img id="mainImageTileImageId" class="ImageTileFrame1" src="assets/images/inputImage.png?lastmod=20241107">

		<img id="mainImageTileProjectileImageId" class="ImageTileFrame1" src="assets/images/inputImage.png?lastmod=20241107">

		<img id="batMonsterImageId" class="ImageTileFrame1" src="assets/images/monsters.png?lastmod=20241110">

		<!-- added by Mike, 20231121 -->
		<img id="mouseInputImageId" class="ImageMouseInput" src="assets/images/inputImageLarge.png">

    <!-- added by Mike, 20231125 -->
    <img id="mainImageMonsterBoss" class="ImageMonsterBoss" src="assets/images/inputImageLarge.png">
    <img id="mainImageMonster0" class="ImageMonster0" src="assets/images/inputImageLarge.png">

	<!-- added by Mike, 20231129 -->
	<img id="mainImageSoldierId" class="ImageMainSoldier" src="assets/images/puzzleStageBG.png">


<!--
		<img id="explosionEffectImageId" class="ImageExplosion" src="assets/images/effects.png">
-->

		<!-- added by Mike, 20231104;
		  note: .html; not .php -->

<!-- set 1 -->
<img id="puzzleTileImageIdBg0" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg1" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg2" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg3" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg4" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">

<!-- set 2 -->
<img id="puzzleTileImageIdBg5" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg6" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg7" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg8" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<!-- set 3 -->
<img id="puzzleTileImageIdBg9" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg10" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg11" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg12" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<!-- set 4 -->
<img id="puzzleTileImageIdBg13" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg14" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg15" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">
<img id="puzzleTileImageIdBg16" class="Image32x32Tile" onerror="" src="assets/images/tile.png" alt="" title="">



	<img id="explosionEffectImageId" class="ImageExplosion" src="assets/images/effects.png">
  <img id="explosionEffectToMonsterImageId" class="ImageExplosion" src="assets/images/effects.png">

    <img id="explosionEffectToCityImageId" class="ImageExplosionToCity" src="assets/images/effects.png">

	<img id="dustEffectImageId" class="ImageDust" src="assets/images/effectsSmall.png">


	<!-- added by Mike, 20221119 -->
	<div id="divPuzzleTileImageTargetBorderId" class="Image32x32TileTargetBorder"></div>

	<!-- added by Mike, 20221121 -->
	<div id="divPuzzleTileImageSpaceBorderId" class="Image32x32TileSpaceBorder"></div>


<!-- removed by Mike, 20231127
	<canvas id="myCanvasSnowEffectId" class="myCanvasSnowEffect">
	</canvas>
 -->
 
	<div id="divSnowEffectId0" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId1" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId2" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId3" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId4" class="myDivSnowEffect"></div>

	<div id="divSnowEffectId5" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId6" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId7" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId8" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId9" class="myDivSnowEffect"></div>

	<!--
	<div id="divSnowEffectId10" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId11" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId12" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId13" class="myDivSnowEffect"></div>
	<div id="divSnowEffectId14" class="myDivSnowEffect"></div>
-->

	<div id="divTransitionEffectId" class="myDivTransitionEffect"></div>

		
	<img id="howToPlayGuideImageId" class="ImageHowToPlayGuide" src="assets/images/gameOff2023HowToPlay.png">
		
	<img id="howToPlayGuideImageFrame2Id" class="ImageHowToPlayGuide" src="assets/images/gameOff2023HowToPlayFrame2.png">
	
	
	<img id="titleImageId" class="ImageTitle" src="assets/images/gameOff2023Title.png">

	<img id="bossBattleBgImageId" class="ImageBossBattleBg" src="assets/images/bgImageCave.png?lastmod=20241104">
	
	<img id="bossBattleBgImagePart2Id" class="ImageBossBattleBgPart2" src="assets/images/bossBattleBgPart2.png">	

	
	<div id="textStatusDivId" class="DivTextStatus">CONGRATULATIONS!</div>
	<div id="textStatusBackgroundDivId" class="DivTextStatusBackground"></div>

	
	<!-- PRESS ENTER; PRESS START -->
	<div id="textEnterDivId" class="DivTextClickStart">START</div>


	<div id="textScoreShadowDivId" class="DivStepCountStatusShadow">0</div>

	<div id="textScoreDivId" class="DivTextScore">0</div>


<!--
	<div id="stepCountStatusDivId" class="DivStepCountStatus">0</div>
-->

  <audio id="myAudioId" class="myAudio" src="assets/audio/usbongGameOff2023BGM.mp3" type="audio/x-m4a" controls loop>
	  Your browser does not support the audio tag.
	</audio><br/>

<!--
	<audio id="myAudioId" class="myAudio" src="assets/audio/usbongGameOff2023BGM.mp3" type="audio/x-m4a">
	  Your browser does not support the audio tag.
	</audio><br/>	
-->	
	

	<audio id="myAudioEffectId" class="myAudio" src="assets/audio/usbongGameOff2023TapLoudEdited.mp3" type="audio/x-m4a">
	  Your browser does not support the audio tag.
	</audio><br/>

	<audio id="myAudioEffectCannonFireId" class="myAudio" src="assets/audio/usbongGameOff2023AudioEffectsCannon.mp3" type="audio/x-m4a">
	  Your browser does not support the audio tag.
	</audio><br/>

<!--
<button onclick="openFullscreen();">Open Fullscreen</button>
-->

  </body>
</html>
